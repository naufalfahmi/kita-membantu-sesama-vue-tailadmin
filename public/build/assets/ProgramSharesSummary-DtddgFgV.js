import{C as S}from"./component-z5TK2YpB.js";import{d as T,b as n,M as C,f as F,g as P,o as B,w as N,a as t,j as _,u as b,S as I}from"./admin-BLTAyufb.js";import{_ as j}from"./AdminLayout.vue_vue_type_script_setup_true_lang-l5AJ9B2_.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},U={class:"mb-6 rounded-lg border border-gray-200 bg-white p-4 dark:border-gray-800 dark:bg-white/[0.03]"},V={class:"grid grid-cols-1 gap-4 md:grid-cols-3 lg:grid-cols-6"},A={class:"flex-1"},M={class:"relative",style:{width:"100%",height:"600px"}},G={class:"ag-theme-alpine dark:ag-theme-alpine-dark",style:{width:"100%",height:"100%"}},X=T({__name:"ProgramSharesSummary",setup(L){const x=n(null),m=C(),s=n(null),v={mode:"range",dateFormat:"Y-m-d",altInput:!0,altFormat:"d F Y"},u=n([{headerName:"Program",field:"program_name",flex:2},{headerName:"Total Transaksi",field:"total_transaksi",flex:1,valueFormatter:d}]),y={resizable:!0,sortable:!0},c=n([]),g=n([]);function d(e){return e.value!==void 0&&e.value!==null?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e.value):""}async function p(){try{let e="/admin/api/keuangan/program-shares-summary";if(s.value&&Array.isArray(s.value)&&s.value.length===2){const[o,i]=s.value;e+=`?start_date=${encodeURIComponent(o)}&end_date=${encodeURIComponent(i)}`}const a=await(await fetch(e,{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}})).json();if(!a.success){m.error("Gagal memuat ringkasan");return}const f=["program_name","total_transaksi",...a.data.columns??[]],l=[];l.push({headerName:"Program",field:"program_name",flex:2}),l.push({headerName:"Total Transaksi",field:"total_transaksi",flex:1,valueFormatter:d});const h=a.data&&a.data.share_type_labels?a.data.share_type_labels:{};(a.data.columns??[]).forEach(o=>{const i=String(o||"").replace(/^custom_/,""),R=h[o]||h[i]||w(i);l.push({headerName:R,field:o,flex:1,valueFormatter:d})}),u.value=l,c.value=a.data.rows||[];const k=Object.assign({program_name:"TOTAL"},a.data.totals||{}),D=Object.assign({program_name:"DISBURSED TOTALS"},a.data.disbursed_totals||{});g.value=[k,D]}catch(e){console.error(e),m.error("Terjadi kesalahan saat memuat ringkasan")}}function w(e){const r={dp:"DP",ops_1:"OPS 1",ops_2:"OPS 2",program:"Program",fee_mitra:"Fee Mitra",bonus:"Bonus",championship:"Championship"};return r[e]?r[e]:String(e||"").replace(/^custom_/,"").replace(/_/g," ").trim().replace(/\b\w/g,f=>f.toUpperCase())}return F(()=>{p()}),(e,r)=>(B(),P(j,null,{default:N(()=>[t("div",O,[t("div",{class:"mb-6 flex items-center justify-between"},[r[1]||(r[1]=t("h3",{class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},"Ringkasan Program - Shares",-1)),t("div",{class:"flex items-center gap-3"},[t("button",{onClick:p,class:"flex items-center gap-2 rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600"}," Muat Ulang ")])]),t("div",U,[t("div",V,[t("div",A,[r[2]||(r[2]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},"Rentang Transaksi (opsional)",-1)),_(b(S),{modelValue:s.value,"onUpdate:modelValue":r[0]||(r[0]=a=>s.value=a),config:v,class:"h-11 w-full rounded-lg border border-gray-300 px-4 py-2.5 text-sm",placeholder:"Pilih rentang"},null,8,["modelValue"])])])]),t("div",M,[t("div",G,[_(b(I),{ref_key:"agGridRef",ref:x,class:"ag-theme-alpine",style:{width:"100%",height:"100%"},columnDefs:u.value,defaultColDef:y,rowData:c.value,pinnedBottomRowData:g.value,animateRows:!0},null,8,["columnDefs","rowData","pinnedBottomRowData"])])])])]),_:1}))}});export{X as default};
