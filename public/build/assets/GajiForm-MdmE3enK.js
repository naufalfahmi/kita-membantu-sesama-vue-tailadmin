import{d as R,M as C,H as M,I as B,b as l,f as V,g as D,o as O,w as F,i as u,a as t,t as I,q as J,k as g,m as N,v as m}from"./admin-B7F6clMI.js";import{_ as $}from"./AdminLayout.vue_vue_type_script_setup_true_lang-wJ6WtAXj.js";import{_ as q}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-H6kmXyiR.js";import{S as c}from"./SearchableSelect-D3bEf5cj.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},K={class:"mb-6 flex items-center justify-between"},H={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},L={class:"grid grid-cols-1 gap-x-6 gap-y-5 lg:grid-cols-2"},X={class:"lg:col-span-2"},z={class:"flex items-center gap-3 mt-6 lg:justify-end"},A={type:"submit",class:"flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 sm:w-auto"},ra=R({__name:"GajiForm",setup(Q){const o=C(),i=M(),f=B(),k=l(String(i.meta.title||"Gaji")),p=l(!1),x=l(!1),r=l({nama:"",nominal:0,tipe:"",tanggal_efektif:"",keterangan:"",jabatan_id:"",pangkat_id:""}),y=l([]),v=l([]),T=l([{value:"bulanan",label:"Bulanan"},{value:"harian",label:"Harian"}]),h=l(""),w=l(""),j=l(""),d=l("");function U(){let n=d.value.replace(/[^\d.,]/g,"");n=n.replace(/\./g,""),n=n.replace(",",".");const e=parseFloat(n)||0;r.value.nominal=e,d.value=new Intl.NumberFormat("id-ID").format(e)}function _(){f.push({name:"Gaji"})}async function P(n){try{const a=await(await fetch(`/admin/api/gaji/${n}`,{credentials:"same-origin"})).json();a.success?(r.value={nama:a.data.nama||"",nominal:a.data.nominal||0,tipe:a.data.tipe||"",tanggal_efektif:a.data.tanggal_efektif||"",keterangan:a.data.keterangan||"",jabatan_id:a.data.jabatan_id?String(a.data.jabatan_id):a.data.jabatan?String(a.data.jabatan.id):"",pangkat_id:a.data.pangkat_id?String(a.data.pangkat_id):a.data.pangkat?String(a.data.pangkat.id):""},d.value=new Intl.NumberFormat("id-ID").format(r.value.nominal||0)):o.error(a.message||"Gagal memuat data")}catch{o.error("Gagal memuat data")}}async function G(){if(!r.value.nama){o.error("Nama gaji wajib diisi");return}if(!r.value.nominal||r.value.nominal<=0){o.error("Nominal gaji wajib diisi dan harus lebih dari 0");return}x.value=!0;try{const e=await(await fetch("/admin/api/csrf-token",{credentials:"same-origin"})).json(),a={nama:r.value.nama,nominal:r.value.nominal,tipe:r.value.tipe,tanggal_efektif:r.value.tanggal_efektif,keterangan:r.value.keterangan,jabatan_id:r.value.jabatan_id||null,pangkat_id:r.value.pangkat_id||null};let s="/admin/api/gaji",S="POST";p.value&&i.params.id&&(s=`/admin/api/gaji/${i.params.id}`,S="PUT");const b=await(await fetch(s,{method:S,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":e.csrf_token},credentials:"same-origin",body:JSON.stringify(a)})).json();b.success?(o.success(b.message||"Berhasil disimpan"),f.push({name:"Gaji"})):o.error(b.message||"Gagal menyimpan")}catch{o.error("Gagal menyimpan")}finally{x.value=!1}}return V(()=>{i.params.id&&(p.value=!0,P(i.params.id))}),V(async()=>{try{const[n,e]=await Promise.all([fetch("/admin/api/jabatan?per_page=1000",{credentials:"same-origin"}),fetch("/admin/api/pangkat?per_page=1000",{credentials:"same-origin"})]),a=await n.json(),s=await e.json();a&&a.success&&(y.value=a.data||[]),s&&s.success&&(v.value=s.data||[])}catch{}}),(n,e)=>(O(),D($,null,{default:F(()=>[u(q,{pageTitle:k.value},null,8,["pageTitle"]),t("div",E,[t("div",K,[t("h3",H,I(k.value),1),t("button",{onClick:_,class:"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]"}," Kembali ")]),t("form",{onSubmit:J(G,["prevent"]),class:"flex flex-col"},[t("div",L,[t("div",null,[e[10]||(e[10]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[N(" Nama "),t("span",{class:"text-red-500"},"*")],-1)),g(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>r.value.nama=a),placeholder:"Masukkan nama gaji",required:"",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[m,r.value.nama]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[N(" Nominal (Rp) "),t("span",{class:"text-red-500"},"*")],-1)),g(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>d.value=a),placeholder:"Masukkan nominal gaji",onInput:U,required:"",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,544),[[m,d.value]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Jabatan ",-1)),u(c,{modelValue:r.value.jabatan_id,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value.jabatan_id=a),options:y.value.map(a=>({value:String(a.id),label:a.name})),placeholder:"Pilih jabatan","search-input":w.value,"onUpdate:searchInput":e[3]||(e[3]=a=>w.value=a)},null,8,["modelValue","options","search-input"])]),t("div",null,[e[13]||(e[13]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Pangkat ",-1)),u(c,{modelValue:r.value.pangkat_id,"onUpdate:modelValue":e[4]||(e[4]=a=>r.value.pangkat_id=a),options:v.value.map(a=>({value:String(a.id),label:a.nama})),placeholder:"Pilih pangkat","search-input":j.value,"onUpdate:searchInput":e[5]||(e[5]=a=>j.value=a)},null,8,["modelValue","options","search-input"])]),t("div",null,[e[14]||(e[14]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Tipe ",-1)),u(c,{modelValue:r.value.tipe,"onUpdate:modelValue":e[6]||(e[6]=a=>r.value.tipe=a),options:T.value,placeholder:"Pilih tipe gaji","search-input":h.value,"onUpdate:searchInput":e[7]||(e[7]=a=>h.value=a)},null,8,["modelValue","options","search-input"])]),t("div",null,[e[15]||(e[15]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Tanggal Efektif ",-1)),g(t("input",{type:"date","onUpdate:modelValue":e[8]||(e[8]=a=>r.value.tanggal_efektif=a),class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[m,r.value.tanggal_efektif]])]),t("div",X,[e[16]||(e[16]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Keterangan ",-1)),g(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=a=>r.value.keterangan=a),placeholder:"Masukkan keterangan gaji (opsional)",rows:"3",class:"dark:bg-dark-900 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[m,r.value.keterangan]])])]),t("div",z,[t("button",{onClick:_,type:"button",class:"flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] sm:w-auto"}," Batal "),t("button",A,I(p.value?"Simpan Perubahan":"Simpan"),1)])],32)])]),_:1}))}});export{ra as default};
