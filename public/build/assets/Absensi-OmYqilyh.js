import{d as A,H as I,I as B,r as s,B as L,o as R,c as z,b,w as F,e as j,f as a,j as h,g as $,t as J,l as K,i as f,v as k,W as G,u as P}from"./admin-BlyFQ4sm.js";import{A as U}from"./ag-theme-alpine-CvVTCDIr.js";import{u as v,w as q}from"./xlsx-3SA47z_C.js";import{_ as X}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BbWfCnc3.js";import{_ as O}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-JbZ_4r6Y.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},Z={class:"mb-6 flex items-center justify-between"},Q={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},Y={class:"mb-6 rounded-lg border border-gray-200 bg-white p-4 dark:border-gray-800 dark:bg-white/[0.03]"},ee={class:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-5"},te={class:"flex-1"},ae={class:"flex-1"},re={class:"flex-1"},le={class:"flex-1"},oe={key:0,class:"flex items-center justify-center py-20"},se={key:1,class:"ag-theme-alpine dark:ag-theme-alpine-dark",style:{width:"100%"}},ne={key:2,class:"flex flex-col items-center justify-center py-20"},fe=A({__name:"Absensi",setup(de){const S=I(),T=B(),y=s(S.meta.title||"Absensi"),m=s(!1),n=s([]),d=s(""),i=s(""),u=s(""),c=s(""),N=[{headerName:"Nama",field:"user.name",sortable:!0,filter:!1,flex:1,valueGetter:t=>{var e,r;return((r=(e=t.data)==null?void 0:e.user)==null?void 0:r.name)||"-"}},{headerName:"No Induk",field:"user.no_induk",sortable:!0,filter:!1,width:120,valueGetter:t=>{var e,r;return((r=(e=t.data)==null?void 0:e.user)==null?void 0:r.no_induk)||"-"}},{headerName:"Kantor Cabang",field:"kantor_cabang.nama",sortable:!0,filter:!1,width:150,valueGetter:t=>{var e,r;return((r=(e=t.data)==null?void 0:e.kantor_cabang)==null?void 0:r.nama)||"-"}},{headerName:"Jam Masuk",field:"jam_masuk",sortable:!0,filter:!1,width:180,valueFormatter:t=>t.value?new Date(t.value).toLocaleString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"},{headerName:"Jam Keluar",field:"jam_keluar",sortable:!0,filter:!1,width:180,valueFormatter:t=>t.value?new Date(t.value).toLocaleString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"},{headerName:"Total Jam",field:"total_jam_kerja",sortable:!0,filter:!1,width:100,valueFormatter:t=>t.value!==null&&t.value!==void 0?`${t.value} jam`:"-"},{headerName:"Status",field:"status",sortable:!0,filter:!1,width:120,cellRenderer:t=>{const e=t.value||"hadir",r={hadir:{label:"Hadir",class:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"},terlambat:{label:"Terlambat",class:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400"},pulang_awal:{label:"Pulang Awal",class:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"},tidak_hadir:{label:"Tidak Hadir",class:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"},izin:{label:"Izin",class:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"},sakit:{label:"Sakit",class:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400"},cuti:{label:"Cuti",class:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-400"}},o=r[e]||r.hadir,g=document.createElement("span");return g.className=`inline-flex px-2 py-1 rounded-full text-xs font-medium ${o.class}`,g.textContent=o.label,g}},{headerName:"Actions",field:"actions",sortable:!1,filter:!1,width:100,cellRenderer:t=>{const e=document.createElement("div");e.className="flex items-center gap-3";const r=document.createElement("button");return r.className="flex items-center justify-center w-8 h-8 rounded-lg text-brand-500 hover:bg-brand-50 dark:hover:bg-brand-500/10 transition-colors",r.innerHTML=`
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>
      `,r.onclick=()=>H(t.data.id),e.appendChild(r),e}}],D={resizable:!0,sortable:!0,filter:!1},V=()=>{var t;return((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},p=async()=>{m.value=!0;try{const t=new URLSearchParams;d.value&&t.append("search",d.value),i.value&&t.append("date_from",i.value),u.value&&t.append("date_to",u.value),c.value&&t.append("status",c.value),t.append("per_page","100");const e=`/admin/api/absensi${t.toString()?"?"+t.toString():""}`,o=await(await fetch(e,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":V()},credentials:"same-origin"})).json();o.success?n.value=o.data||[]:(console.error("Failed to fetch data:",o.message),n.value=[])}catch(t){console.error("Error fetching data:",t),n.value=[]}finally{m.value=!1}},H=t=>{T.push(`/operasional/absensi/${t}`)},E=()=>{const t=n.value.map(l=>{var w,_,C;return{Nama:((w=l.user)==null?void 0:w.name)||"-","No Induk":((_=l.user)==null?void 0:_.no_induk)||"-","Kantor Cabang":((C=l.kantor_cabang)==null?void 0:C.nama)||"-","Jam Masuk":l.jam_masuk?new Date(l.jam_masuk).toLocaleString("id-ID"):"-","Jam Keluar":l.jam_keluar?new Date(l.jam_keluar).toLocaleString("id-ID"):"-","Total Jam Kerja":l.total_jam_kerja?`${l.total_jam_kerja} jam`:"-",Status:l.status||"-",Catatan:l.catatan||"-"}}),e=v.json_to_sheet(t),r=v.book_new();v.book_append_sheet(r,e,"Absensi");const g=`Absensi_${new Date().toISOString().split("T")[0]}.xlsx`;q(r,g)},M=()=>{d.value="",i.value="",u.value="",c.value="",p()};let x=null;return L([d,i,u,c],()=>{x&&clearTimeout(x),x=setTimeout(()=>{p()},500)}),R(()=>{p()}),(t,e)=>(b(),z(X,null,{default:F(()=>[j(O,{pageTitle:y.value},null,8,["pageTitle"]),a("div",W,[a("div",Z,[a("h3",Q,J(y.value),1),a("button",{onClick:E,class:"flex items-center gap-2 rounded-lg bg-green-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-green-600"},[...e[4]||(e[4]=[a("svg",{class:"fill-current",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:"M10.8333 3.33333V9.16667H16.6667L10.8333 3.33333ZM4.16667 2.5H11.6667L17.5 8.33333V15.8333C17.5 16.2754 17.3244 16.6993 17.0118 17.0118C16.6993 17.3244 16.2754 17.5 15.8333 17.5H4.16667C3.72464 17.5 3.30072 17.3244 2.98816 17.0118C2.67559 16.6993 2.5 16.2754 2.5 15.8333V4.16667C2.5 3.72464 2.67559 3.30072 2.98816 2.98816C3.30072 2.67559 3.72464 2.5 4.16667 2.5Z",fill:"currentColor"})],-1),K(" Export Excel ",-1)])])]),a("div",Y,[a("div",ee,[a("div",te,[e[5]||(e[5]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Nama / No Induk ",-1)),f(a("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=r=>d.value=r),placeholder:"Cari nama atau no induk...",class:"h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[k,d.value]])]),a("div",ae,[e[6]||(e[6]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Tanggal Dari ",-1)),f(a("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=r=>i.value=r),class:"h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[k,i.value]])]),a("div",re,[e[7]||(e[7]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Tanggal Sampai ",-1)),f(a("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=r=>u.value=r),class:"h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[k,u.value]])]),a("div",le,[e[9]||(e[9]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Status ",-1)),f(a("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>c.value=r),class:"h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800"},[...e[8]||(e[8]=[a("option",{value:""},"Semua Status",-1),a("option",{value:"hadir"},"Hadir",-1),a("option",{value:"terlambat"},"Terlambat",-1),a("option",{value:"pulang_awal"},"Pulang Awal",-1),a("option",{value:"tidak_hadir"},"Tidak Hadir",-1),a("option",{value:"izin"},"Izin",-1),a("option",{value:"sakit"},"Sakit",-1),a("option",{value:"cuti"},"Cuti",-1)])],512),[[G,c.value]])]),a("div",{class:"flex items-end"},[a("button",{onClick:M,class:"h-11 w-full rounded-lg border border-gray-300 bg-white px-6 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]"}," Reset Filter ")])])]),m.value?(b(),h("div",oe,[...e[10]||(e[10]=[a("div",{class:"flex flex-col items-center gap-4"},[a("div",{class:"h-12 w-12 animate-spin rounded-full border-4 border-brand-500 border-t-transparent"}),a("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Memuat data absensi...")],-1)])])):(b(),h("div",se,[j(P(U),{class:"ag-theme-alpine",style:{width:"100%"},columnDefs:N,rowData:n.value,defaultColDef:D,pagination:!0,paginationPageSize:20,theme:"legacy",animateRows:!0,suppressHorizontalScroll:!0,domLayout:"autoHeight"},null,8,["rowData"])])),!m.value&&n.value.length===0?(b(),h("div",ne,[...e[11]||(e[11]=[a("svg",{class:"w-16 h-16 text-gray-400 dark:text-gray-500 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),a("p",{class:"text-gray-600 dark:text-gray-400 text-lg font-medium mb-1"}," Tidak ada data absensi ",-1),a("p",{class:"text-gray-500 dark:text-gray-500 text-sm"}," Belum ada data absensi yang tersedia ",-1)])])):$("",!0)])]),_:1}))}});export{fe as default};
