import{d as H,H as R,I as B,A as w,b as x,f as C,g as F,o,w as I,a as t,c as d,t as n,n as z,F as L,l as q}from"./admin-suzLmzp7.js";import{_ as X}from"./AdminLayout.vue_vue_type_script_setup_true_lang-pjs48Xdu.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},K={key:0,class:"flex items-center justify-center py-20"},N={key:1,class:"space-y-6"},V={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-700 dark:bg-white/[0.03]"},E={class:"mb-6 flex items-center justify-between"},O={class:"flex items-center gap-4"},W={class:"text-2xl font-bold text-gray-800 dark:text-white/90"},Y={class:"text-gray-600 dark:text-gray-400"},P={class:"grid grid-cols-1 gap-4 sm:grid-cols-3"},U={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},G={class:"text-xl font-bold text-gray-800 dark:text-white/90"},J={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},Q={class:"text-xl font-bold text-gray-800 dark:text-white/90"},Z={class:"rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},tt={class:"text-xl font-bold text-gray-800 dark:text-white/90"},et={class:"rounded-lg border border-gray-200 bg-white shadow-sm dark:border-gray-700 dark:bg-white/[0.03]"},at={class:"p-6"},rt={key:0,class:"overflow-x-auto"},st={class:"w-full"},nt={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-300"},ot={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-300"},lt={class:"px-4 py-3 text-right text-sm font-semibold text-gray-800 dark:text-white/90"},it={class:"px-4 py-3 text-center text-sm text-gray-700 dark:text-gray-300"},dt={key:1,class:"flex flex-col items-center justify-center py-12 text-center"},gt={key:2,class:"flex flex-col items-center justify-center py-20 text-center"},ut=H({__name:"DetailMitra",setup(ct){const v=R(),M=B();w(()=>"Detail Mitra");const m=x(!0),a=x(null),l=x([]),i=x({current_page:1,last_page:1,per_page:20,total:0}),g=x([new Date(new Date().getFullYear()-(new Date().getMonth()<new Date().getMonth(),0),new Date().getMonth(),new Date().getDate()).toISOString().split("T")[0]]),k=new Date;k.setFullYear(k.getFullYear()-1),g.value=[k.toISOString().split("T")[0],new Date().toISOString().split("T")[0]];const f=x(!1),D=w(()=>l.value.reduce((r,e)=>r+(e.nominal||0),0)),b=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r),j=r=>r?new Date(r).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}):"-",S=async()=>{m.value=!0;try{const r=v.params.id,e=await fetch(`/admin/api/laporan/mitra/${r}`,{headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(!e.ok){a.value=null;return}const s=await e.json();if(!s.success){a.value=null;return}a.value=s.data||null}catch(r){console.error("Error fetching mitra detail",r),a.value=null}finally{m.value=!1}},T=async(r=1)=>{try{m.value=!0,i.value.current_page=r;const e=v.params.id,s=new URLSearchParams;s.append("page",String(r)),s.append("per_page",String(i.value.per_page||20)),Array.isArray(g.value)&&g.value[0]&&(s.append("tanggal_from",g.value[0]),g.value[1]&&s.append("tanggal_to",g.value[1]));const y=await fetch(`/admin/api/laporan/mitra/${e}/transaksi?${s.toString()}`,{headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(!y.ok)return;const u=await y.json();if(!u.success)return;if(l.value=u.data||[],i.value={...u.pagination||{},per_page:i.value.per_page},u.totals&&(a.value.transaksi_count=u.totals.count||a.value.transaksi_count,a.value.transaksi_total=u.totals.nominal||a.value.transaksi_total),(!l.value||l.value.length===0)&&a.value&&(a.value.transaksi_count||0)>0&&!f.value){f.value=!0;try{const p=new URLSearchParams;p.append("page",String(r)),p.append("per_page",String(i.value.per_page||20));const _=await fetch(`/admin/api/laporan/mitra/${e}/transaksi?${p.toString()}`,{headers:{"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(_.ok){const c=await _.json();c.success&&(l.value=c.data||[],i.value={...c.pagination||{},per_page:i.value.per_page},c.totals&&(a.value.transaksi_count=c.totals.count||a.value.transaksi_count,a.value.transaksi_total=c.totals.nominal||a.value.transaksi_total))}}catch(p){console.error("Fallback fetch failed",p)}}}catch(e){console.error("Error fetching mitra transactions",e)}finally{m.value=!1}},h=()=>{M.push("/laporan/laporan-keuangan?tab=mitra")};return C(async()=>{await S(),await T(1)}),(r,e)=>(o(),F(X,null,{default:I(()=>[t("div",A,[t("div",{class:"mb-6 flex items-center justify-between"},[t("div",{class:"flex items-center gap-4"},[t("button",{onClick:h,class:"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]"},[...e[0]||(e[0]=[t("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),e[1]||(e[1]=t("div",null,[t("h3",{class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"}," Detail Mitra "),t("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Informasi lengkap dan history transaksi mitra ")],-1))])]),m.value?(o(),d("div",K,[...e[2]||(e[2]=[t("div",{class:"text-center"},[t("div",{class:"mb-4 inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-brand-500 border-r-transparent"}),t("p",{class:"text-gray-600 dark:text-gray-400"},"Memuat data...")],-1)])])):a.value?(o(),d("div",N,[t("div",V,[t("div",E,[t("div",O,[e[3]||(e[3]=t("div",{class:"flex h-16 w-16 items-center justify-center rounded-lg bg-brand-500 text-white dark:bg-brand-500/10 dark:text-white/90"},[t("svg",{class:"h-8 w-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),t("div",null,[t("h2",W,n(a.value.nama),1),t("p",Y,n(a.value.program),1)])]),t("span",{class:z(["rounded-full px-4 py-2 text-sm font-medium",a.value.status==="Aktif"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400"])},n(a.value.status),3)]),t("div",P,[t("div",U,[e[4]||(e[4]=t("p",{class:"mb-1 text-sm font-medium text-gray-600 dark:text-gray-400"}," Fee Mitra ",-1)),t("p",G,n(b(a.value.nominal||0)),1)]),t("div",J,[e[5]||(e[5]=t("p",{class:"mb-1 text-sm font-medium text-gray-600 dark:text-gray-400"}," Total Transaksi ",-1)),t("p",Q,n(a.value.transaksi_count||0),1)]),t("div",Z,[e[6]||(e[6]=t("p",{class:"mb-1 text-sm font-medium text-gray-600 dark:text-gray-400"}," Total Nilai Transaksi ",-1)),t("p",tt,n(b(a.value.transaksi_total||D.value)),1)])])]),t("div",et,[e[9]||(e[9]=t("div",{class:"border-b border-gray-200 p-6 dark:border-gray-700"},[t("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"}," History Transaksi ")],-1)),t("div",at,[l.value.length>0?(o(),d("div",rt,[t("table",st,[e[7]||(e[7]=t("thead",null,[t("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 dark:text-gray-300"}," Tanggal "),t("th",{class:"px-4 py-3 text-left text-sm font-semibold text-gray-700 dark:text-gray-300"}," Keterangan "),t("th",{class:"px-4 py-3 text-right text-sm font-semibold text-gray-700 dark:text-gray-300"}," Nominal "),t("th",{class:"px-4 py-3 text-center text-sm font-semibold text-gray-700 dark:text-gray-300"}," Kantor ")])],-1)),t("tbody",null,[(o(!0),d(L,null,q(l.value,(s,y)=>(o(),d("tr",{key:s.id||y,class:"border-b border-gray-100 transition-colors hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-white/[0.03]"},[t("td",nt,n(j(s.tanggal)),1),t("td",ot,n(s.keterangan),1),t("td",lt,n(b(s.nominal)),1),t("td",it,n(s.kantor||"-"),1)]))),128))])])])):(o(),d("div",dt,[...e[8]||(e[8]=[t("svg",{class:"mb-4 h-16 w-16 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),t("p",{class:"text-lg font-medium text-gray-600 dark:text-gray-400"}," Belum ada transaksi ",-1),t("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-500"}," History transaksi akan muncul di sini ",-1)])]))])])])):(o(),d("div",gt,[e[10]||(e[10]=t("svg",{class:"mb-4 h-16 w-16 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),e[11]||(e[11]=t("p",{class:"text-lg font-medium text-gray-600 dark:text-gray-400"}," Data mitra tidak ditemukan ",-1)),t("button",{onClick:h,class:"mt-4 rounded-lg bg-brand-500 px-4 py-2 text-sm font-medium text-white hover:bg-brand-600"}," Kembali ke Laporan Keuangan ")]))])]),_:1}))}}),yt=$(ut,[["__scopeId","data-v-b7af9b36"]]);export{yt as default};
