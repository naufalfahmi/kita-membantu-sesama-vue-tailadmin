import{_ as x}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Bc44eTII.js";import{d as y,A as k,O as b,H as v,I as _,M as j,b as N,f as C,g as D,o as M,w as P,a as o,j as R,u as $,P as B}from"./admin-BXgqhMOc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},A={class:"ag-theme-alpine dark:ag-theme-alpine-dark",style:{width:"100%","min-height":"400px"}},V=y({__name:"PayrollDetail",setup(H){const{hasPermission:m,isAdmin:u}=b(),p=k(()=>u()||m("update remunerasi")),i=v(),d=_(),l=j(),c=N([]),g=[{headerName:"Nama Karyawan",field:"name",flex:1},{headerName:"Total",field:"total",width:200,cellRenderer:r=>{const t=document.createElement("span");t.className="text-sm font-medium text-gray-800";const n=r.value||0,a=w(n);return t.textContent=a,t}},{headerName:"Status",field:"status",width:150,cellRenderer:r=>{const t={pending:"Pending",locked:"Selesai",transferred:"Ditransfer"},n={pending:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",locked:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",transferred:"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400"},a=document.createElement("span"),e=r.value||"";return a.className=`inline-block rounded-full px-3 py-1 text-xs font-medium ${n[e]||"bg-gray-100 text-gray-800"}`,a.textContent=t[e]||e,a}},{headerName:"Actions",field:"actions",width:160,cellRenderer:r=>{const t=document.createElement("div");t.className="flex items-center gap-2 justify-end";const n=i.params.id;if(p.value){const e=document.createElement("button");e.type="button",e.title="Edit",e.className="flex items-center justify-center w-8 h-8 rounded-lg text-brand-500 hover:bg-brand-50",e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"/></svg>',e.onclick=s=>{s.stopPropagation(),d.push(`/operasional/payroll/${n}/records/${r.data.record_id}/edit`)},t.appendChild(e)}const a=document.createElement("button");return a.type="button",a.title="Cetak Slip Gaji",a.className="flex items-center justify-center w-8 h-8 rounded-lg text-gray-700 hover:bg-gray-100",a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="9" width="12" height="8" rx="2" ry="2"/><path d="M6 13H4a2 2 0 0 0-2 2v4h20v-4a2 2 0 0 0-2-2h-2"/><path d="M6 9V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4"/></svg>',a.onclick=async e=>{e.stopPropagation();try{(await(await fetch("/admin/api/debug-auth",{credentials:"same-origin"})).json()).authenticated?window.open(`/admin/operasional/payroll/periods/${n}/records/${r.data.record_id}/slip?format=pdf`,"_blank"):(l.error("Sesi kadaluarsa, silakan masuk kembali"),d.push("/signin"))}catch{l.error("Gagal memeriksa status autentikasi")}},t.appendChild(a),t}}],h={resizable:!0,sortable:!0},f=async()=>{const r=i.params.id,a=(await(await fetch(`/admin/api/operasional/payroll/periods/${r}`,{credentials:"same-origin"})).json()).data;a&&(c.value=(a.records||[]).map(e=>({record_id:e.id,name:e.employee?e.employee.name:"",total:e.total_amount||0,status:e.status})))},w=r=>{const t=Number(r||0);return`Rp. ${new Intl.NumberFormat("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}`};return C(f),(r,t)=>(M(),D(x,null,{default:P(()=>[o("div",E,[t[0]||(t[0]=o("div",{class:"mb-6 flex items-center justify-between"},[o("h3",{class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},"Detail Periode")],-1)),o("div",A,[R($(B),{class:"ag-theme-alpine",style:{width:"100%"},columnDefs:g,rowData:c.value,defaultColDef:h,pagination:!0,paginationPageSize:20,animateRows:!0,domLayout:"autoHeight"},null,8,["rowData"])])])]),_:1}))}});export{V as default};
