import{d as j,H as C,I as S,M as R,A as x,e as b,f as E,g as M,o as y,w as N,a as e,t as c,q,k as h,c as P,i as B,m as O,n as V,v as k}from"./admin-DE34o4oK.js";import{_ as X}from"./AdminLayout.vue_vue_type_script_setup_true_lang-B_NZxCTe.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},D={class:"mb-6 flex items-center justify-between"},F={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},$={class:"grid grid-cols-1 gap-x-6 gap-y-5 lg:grid-cols-2"},H={class:"lg:col-span-1"},U={key:0,class:"mt-1 text-xs text-red-500"},A={class:"lg:col-span-1"},K={class:"flex items-center gap-3 mt-6 lg:justify-end"},L={type:"submit",class:"flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 sm:w-auto"},Q=j({__name:"TipeProgramForm",setup(W){const d=C(),l=S(),o=R(),n=x(()=>d.params.id!==void 0&&d.params.id!=="new"),w=x(()=>n.value?"Edit Tipe Program":"Tambah Tipe Program"),s=b({name:"",orders:0}),m=b({name:""}),p=async()=>{var t;const r=(t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content");if(r)return r;try{return(await(await fetch("/admin/api/csrf-token",{method:"GET",credentials:"same-origin"})).json()).csrf_token||""}catch(a){return console.error(a),""}},v=async()=>{if(!(!n.value||!d.params.id))try{const r=await p(),a=await(await fetch(`/admin/api/tipe-program/${d.params.id}`,{method:"GET",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":r,"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).json();a.success&&a.data?(s.name=a.data.name||"",s.orders=a.data.orders??0):(o.error("Gagal memuat data tipe program"),l.push("/administrasi/program/tipe-program"))}catch(r){console.error(r),o.error("Terjadi kesalahan saat memuat data"),l.push("/administrasi/program/tipe-program")}},u=()=>l.push("/administrasi/program/tipe-program"),T=async()=>{if(!s.name.trim()){o.error("Nama tipe wajib diisi");return}m.name="";const r=await p();if(!r){o.error("Gagal mendapatkan CSRF token. Silakan refresh.");return}const t={name:s.name.trim(),orders:s.orders},a=n.value?`/admin/api/tipe-program/${d.params.id}`:"/admin/api/tipe-program",g=n.value?"PUT":"POST";try{const i=await(await fetch(a,{method:g,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":r,"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin",body:JSON.stringify(t)})).json();if(i.success)o.success(n.value?"Tipe program berhasil diupdate":"Tipe program berhasil ditambahkan"),l.push("/administrasi/program/tipe-program");else if(i.errors){i.errors.name&&(m.name=i.errors.name[0]);const _=Object.values(i.errors).flat().join(", ");o.error(`Validasi gagal: ${_}`)}else o.error(i.message||"Gagal menyimpan data")}catch(f){console.error(f),o.error("Terjadi kesalahan saat menyimpan data")}};return E(()=>v()),(r,t)=>(y(),M(X,null,{default:N(()=>[e("div",G,[e("div",D,[e("h3",F,c(w.value),1),e("button",{onClick:u,class:"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50"},"Batal")]),e("form",{onSubmit:q(T,["prevent"]),class:"flex flex-col"},[e("div",$,[e("div",H,[t[2]||(t[2]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[O("Nama Tipe "),e("span",{class:"text-red-500"},"*")],-1)),h(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>s.name=a),placeholder:"Masukkan nama tipe",required:"",class:V(["h-11 w-full rounded-lg border bg-transparent px-4 py-2.5 text-sm text-gray-800",m.name?"border-red-500":"border-gray-300"])},null,2),[[k,s.name]]),m.name?(y(),P("p",U,c(m.name),1)):B("",!0)]),e("div",A,[t[3]||(t[3]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},"Order",-1)),h(e("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=a=>s.orders=a),min:"0",class:"h-11 w-full rounded-lg border bg-transparent px-4 py-2.5 text-sm text-gray-800"},null,512),[[k,s.orders,void 0,{number:!0}]])])]),e("div",K,[e("button",{onClick:u,type:"button",class:"flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 sm:w-auto"},"Batal"),e("button",L,c(n.value?"Simpan Perubahan":"Simpan"),1)])],32)])]),_:1}))}});export{Q as default};
