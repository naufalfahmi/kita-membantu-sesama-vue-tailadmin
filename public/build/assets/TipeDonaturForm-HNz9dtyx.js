import{d as T,H as _,I as j,M as C,A as f,e as b,f as S,B as E,g as R,o as y,w as D,a,t as u,q as M,k as q,c as B,i as F,m as N,n as X,v as G}from"./admin-Biv5KfXp.js";import{_ as O}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DU5cqfsp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const V={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},$={class:"mb-6 flex items-center justify-between"},A={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},P={class:"grid grid-cols-1 gap-x-6 gap-y-5 lg:grid-cols-2"},H={class:"lg:col-span-1"},K={key:0,class:"mt-1 text-xs text-red-500"},L={class:"flex items-center gap-3 mt-6 lg:justify-end"},U={type:"submit",class:"flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 sm:w-auto"},Q=T({__name:"TipeDonaturForm",setup(W){const c=_(),l=j(),s=C(),n=f(()=>c.params.id!==void 0&&c.params.id!=="new"),x=f(()=>n.value?"Edit Tipe Donatur":"Tambah Tipe Donatur"),i=b({nama:""}),o=b({nama:""}),m=async()=>{var r;const t=(r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content");if(t)return t;try{const e=await fetch("/admin/api/csrf-token",{method:"GET",credentials:"same-origin"});if(!e.ok)throw new Error(`Failed to fetch CSRF token: ${e.status}`);return(await e.json()).csrf_token||""}catch(e){return console.error("Error fetching CSRF token:",e),""}},k=async()=>{if(!(!n.value||!c.params.id))try{const t=await m(),e=await(await fetch(`/admin/api/tipe-donatur/${c.params.id}`,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":t},credentials:"same-origin"})).json();e.success&&e.data?i.nama=e.data.nama||"":(s.error("Gagal memuat data tipe donatur"),l.push("/administrasi/tipe-donatur"))}catch(t){console.error("Error loading tipe donatur:",t),s.error("Terjadi kesalahan saat memuat data"),l.push("/administrasi/tipe-donatur")}},p=()=>{l.push("/administrasi/tipe-donatur")},w=async()=>{if(!i.nama.trim()){s.error("Tipe Donatur wajib diisi");return}o.nama="";const t=await m();if(!t){s.error("Gagal mendapatkan CSRF token. Silakan refresh halaman.");return}const r={nama:i.nama.trim()},e=n.value?`/admin/api/tipe-donatur/${c.params.id}`:"/admin/api/tipe-donatur",g=n.value?"PUT":"POST";try{const d=await(await fetch(e,{method:g,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":t},credentials:"same-origin",body:JSON.stringify(r)})).json();if(d.success)o.nama="",s.success(n.value?"Tipe donatur berhasil diupdate":"Tipe donatur berhasil ditambahkan"),l.push("/administrasi/tipe-donatur");else if(d.errors){d.errors.nama&&(o.nama=d.errors.nama[0]);const v=Object.values(d.errors).flat().join(", ");s.error(`Validasi gagal: ${v}`)}else s.error(d.message||"Gagal menyimpan data tipe donatur")}catch(h){console.error("Error saving tipe donatur:",h),s.error("Terjadi kesalahan saat menyimpan data")}};return S(()=>{k()}),E(()=>i.nama,()=>{o.nama=""}),(t,r)=>(y(),R(O,null,{default:D(()=>[a("div",V,[a("div",$,[a("h3",A,u(x.value),1),a("button",{onClick:p,class:"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]"}," Batal ")]),a("form",{onSubmit:M(w,["prevent"]),class:"flex flex-col"},[a("div",P,[a("div",H,[r[1]||(r[1]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[N(" Tipe Donatur "),a("span",{class:"text-red-500"},"*")],-1)),q(a("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=e=>i.nama=e),placeholder:"Masukkan tipe donatur",required:"",class:X(["dark:bg-dark-900 h-11 w-full rounded-lg border bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30",o.nama?"border-red-500 focus:border-red-500 dark:border-red-500 dark:focus:border-red-500":"border-gray-300 focus:border-brand-300 dark:border-gray-700 dark:focus:border-brand-800"])},null,2),[[G,i.nama]]),o.nama?(y(),B("p",K,u(o.nama),1)):F("",!0)])]),a("div",L,[a("button",{onClick:p,type:"button",class:"flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] sm:w-auto"}," Batal "),a("button",U,u(n.value?"Simpan Perubahan":"Simpan"),1)])],32)])]),_:1}))}});export{Q as default};
