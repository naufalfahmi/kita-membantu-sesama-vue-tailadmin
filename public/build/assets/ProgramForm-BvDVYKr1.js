import{g as T,r as F,H as S,I as V,V as C,A as k,i as H,B as U,o as R,c as M,a as O,w as E,f as y,b as r,t as f,p as N,j as o,l as q,v as l}from"./admin-V6h7w0fV.js";import{_ as B}from"./AdminLayout.vue_vue_type_script_setup_true_lang-B1sBarRz.js";import{_ as X}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-CNiorqf7.js";import{S as $}from"./SearchableSelect-B7hGtA83.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},A={class:"mb-6 flex items-center justify-between"},D={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},I={class:"grid grid-cols-1 gap-x-6 gap-y-5 lg:grid-cols-2"},J={class:"lg:col-span-2"},K={class:"lg:col-span-1"},L={class:"lg:col-span-1"},W={class:"lg:col-span-1"},z={class:"lg:col-span-1 grid grid-cols-1 gap-x-6 gap-y-5 lg:grid-cols-2"},Q={class:"lg:col-span-1"},Y={class:"lg:col-span-1"},Z={class:"lg:col-span-1"},ee={class:"lg:col-span-1"},ae={class:"lg:col-span-1"},re={class:"lg:col-span-1"},te={class:"lg:col-span-1"},se=["value"],ne={class:"flex items-center gap-3 mt-6 lg:justify-end"},oe={type:"submit",class:"flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 sm:w-auto"},ue=T({__name:"ProgramForm",setup(le){const w=[{value:"percentage",label:"Persentase"},{value:"nominal",label:"Nominal"}],h=F(""),g=S(),m=V(),d=C(),p=k(()=>g.params.id!==void 0&&g.params.id!=="new"),b=k(()=>p.value?"Edit Program":"Tambah Program"),e=H({nama_program:"",persentase_hak_program:null,persentase_hak_program_operasional:null,persentase_hak_championship:null,tipe_pembagian_marketing:"",persentase_hak_marketing:null,persentase_hak_operasional_1:null,persentase_hak_iklan:null,persentase_hak_operasional_2:null,persentase_hak_operasional_3:null,jumlah_persentase:null}),_=k(()=>{let s=0;return e.persentase_hak_program!==null&&(s+=e.persentase_hak_program),e.persentase_hak_program_operasional!==null&&(s+=e.persentase_hak_program_operasional),e.persentase_hak_championship!==null&&(s+=e.persentase_hak_championship),e.persentase_hak_marketing!==null&&(s+=e.persentase_hak_marketing),e.persentase_hak_operasional_1!==null&&(s+=e.persentase_hak_operasional_1),e.persentase_hak_iklan!==null&&(s+=e.persentase_hak_iklan),e.persentase_hak_operasional_2!==null&&(s+=e.persentase_hak_operasional_2),e.persentase_hak_operasional_3!==null&&(s+=e.persentase_hak_operasional_3),s>0?parseFloat(s.toFixed(2)):0});U([()=>e.persentase_hak_program,()=>e.persentase_hak_program_operasional,()=>e.persentase_hak_championship,()=>e.tipe_pembagian_marketing,()=>e.persentase_hak_marketing,()=>e.persentase_hak_operasional_1,()=>e.persentase_hak_iklan,()=>e.persentase_hak_operasional_2,()=>e.persentase_hak_operasional_3],()=>{e.jumlah_persentase=_.value},{immediate:!0});const c=async()=>{var s;try{const a=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content");if(a)return a;const t=await fetch("/admin/api/csrf-token",{method:"GET",credentials:"same-origin"});if(!t.ok)throw new Error(`Failed to get CSRF token: ${t.status}`);return(await t.json()).csrf_token||""}catch(a){return console.error("Failed to get CSRF token:",a),""}},v=async()=>{if(p.value&&g.params.id){const s=g.params.id;try{const a=await c(),i=await(await fetch(`/admin/api/program/${s}`,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":a},credentials:"same-origin"})).json();if(i.success&&i.data){const n=i.data;e.nama_program=n.nama_program||"",e.persentase_hak_program=n.persentase_hak_program?parseFloat(n.persentase_hak_program):null,e.persentase_hak_program_operasional=n.persentase_hak_program_operasional?parseFloat(n.persentase_hak_program_operasional):null,e.persentase_hak_championship=n.persentase_hak_championship?parseFloat(n.persentase_hak_championship):null,e.tipe_pembagian_marketing=n.tipe_pembagian_marketing||"",e.persentase_hak_marketing=n.persentase_hak_marketing?parseFloat(n.persentase_hak_marketing):null,e.persentase_hak_operasional_1=n.persentase_hak_operasional_1?parseFloat(n.persentase_hak_operasional_1):null,e.persentase_hak_iklan=n.persentase_hak_iklan?parseFloat(n.persentase_hak_iklan):null,e.persentase_hak_operasional_2=n.persentase_hak_operasional_2?parseFloat(n.persentase_hak_operasional_2):null,e.persentase_hak_operasional_3=n.persentase_hak_operasional_3?parseFloat(n.persentase_hak_operasional_3):null,e.jumlah_persentase=n.jumlah_persentase?parseFloat(n.jumlah_persentase):null}else d.error("Gagal memuat data program"),m.push("/administrasi/program")}catch(a){console.error("Error loading data:",a),d.error("Terjadi kesalahan saat memuat data"),m.push("/administrasi/program")}}},x=()=>{m.push("/administrasi/program")},P=async()=>{if(!e.nama_program){d.error("Nama Program wajib diisi");return}try{const s=await c();if(!s){d.error("Gagal mendapatkan CSRF token. Silakan refresh halaman.");return}const a={nama_program:e.nama_program,persentase_hak_program:e.persentase_hak_program||null,persentase_hak_program_operasional:e.persentase_hak_program_operasional||null,persentase_hak_championship:e.persentase_hak_championship||null,tipe_pembagian_marketing:e.tipe_pembagian_marketing||null,persentase_hak_marketing:e.persentase_hak_marketing||null,persentase_hak_operasional_1:e.persentase_hak_operasional_1||null,persentase_hak_iklan:e.persentase_hak_iklan||null,persentase_hak_operasional_2:e.persentase_hak_operasional_2||null,persentase_hak_operasional_3:e.persentase_hak_operasional_3||null,jumlah_persentase:_.value||null},t=p.value?`/admin/api/program/${g.params.id}`:"/admin/api/program",i=p.value?"PUT":"POST",u=await(await fetch(t,{method:i,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":s},credentials:"same-origin",body:JSON.stringify(a)})).json();if(u.success)d.success(p.value?"Program berhasil diupdate":"Program berhasil ditambahkan"),m.push("/administrasi/program");else if(u.errors){const j=Object.values(u.errors).flat().join(", ");d.error(`Validasi gagal: ${j}`)}else d.error(u.message||"Gagal menyimpan data")}catch(s){console.error("Error saving:",s),d.error("Terjadi kesalahan saat menyimpan data")}};return R(()=>{v()}),(s,a)=>(O(),M(B,null,{default:E(()=>[y(X,{pageTitle:b.value},null,8,["pageTitle"]),r("div",G,[r("div",A,[r("h3",D,f(b.value),1),r("button",{onClick:x,class:"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]"}," Batal ")]),r("form",{onSubmit:N(P,["prevent"]),class:"flex flex-col"},[r("div",I,[r("div",J,[a[11]||(a[11]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[q(" Nama Program "),r("span",{class:"text-red-500"},"*")],-1)),o(r("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=t=>e.nama_program=t),placeholder:"Masukkan nama program",required:"",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.nama_program]])]),r("div",K,[a[12]||(a[12]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Program ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[1]||(a[1]=t=>e.persentase_hak_program=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_program,void 0,{number:!0}]])]),r("div",L,[a[13]||(a[13]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Program Operasional ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=t=>e.persentase_hak_program_operasional=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_program_operasional,void 0,{number:!0}]])]),r("div",W,[a[14]||(a[14]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Championship ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[3]||(a[3]=t=>e.persentase_hak_championship=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_championship,void 0,{number:!0}]])]),r("div",z,[r("div",Q,[a[15]||(a[15]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Marketing ",-1)),y($,{modelValue:e.tipe_pembagian_marketing,"onUpdate:modelValue":a[4]||(a[4]=t=>e.tipe_pembagian_marketing=t),options:w,placeholder:"Pilih Tipe Pembagian","search-input":h.value,"onUpdate:searchInput":a[5]||(a[5]=t=>h.value=t)},null,8,["modelValue","search-input"])]),r("div",Y,[a[16]||(a[16]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Marketing ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[6]||(a[6]=t=>e.persentase_hak_marketing=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_marketing,void 0,{number:!0}]])])]),r("div",Z,[a[17]||(a[17]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Operasional 1 ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[7]||(a[7]=t=>e.persentase_hak_operasional_1=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_operasional_1,void 0,{number:!0}]])]),r("div",ee,[a[18]||(a[18]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Iklan ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[8]||(a[8]=t=>e.persentase_hak_iklan=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_iklan,void 0,{number:!0}]])]),r("div",ae,[a[19]||(a[19]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Operasional 2 ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[9]||(a[9]=t=>e.persentase_hak_operasional_2=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_operasional_2,void 0,{number:!0}]])]),r("div",re,[a[20]||(a[20]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Operasional 3 ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[10]||(a[10]=t=>e.persentase_hak_operasional_3=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_operasional_3,void 0,{number:!0}]])]),r("div",te,[a[21]||(a[21]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Jumlah Persentase ",-1)),r("input",{type:"number",value:_.value,placeholder:"0",min:"0",max:"100",step:"0.01",readonly:"",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-800 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800 cursor-not-allowed opacity-60"},null,8,se),a[22]||(a[22]=r("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Total dari semua persentase ",-1))])]),r("div",ne,[r("button",{onClick:x,type:"button",class:"flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] sm:w-auto"}," Batal "),r("button",oe,f(p.value?"Simpan Perubahan":"Simpan"),1)])],32)])]),_:1}))}});export{ue as default};
