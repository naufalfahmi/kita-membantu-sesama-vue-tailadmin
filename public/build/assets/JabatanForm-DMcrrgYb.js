import{d as U,H as G,I as z,M as W,A as v,b as _,f as M,g as Q,o as g,w as Y,a as e,t as m,q as i,k as P,m as I,v as T,c as w,i as Z,F as E,l as L}from"./admin-rllO9cM4.js";import{_ as ee}from"./AdminLayout.vue_vue_type_script_setup_true_lang-C6m0A9-C.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},re={class:"mb-6 flex items-center justify-between"},se={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},ne={class:"mb-6"},oe={class:"mb-6"},ie={class:"mb-4 flex items-center justify-between"},de={class:"flex items-center gap-3"},le={class:"mb-4 flex items-center gap-4 rounded-lg border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-800/50"},ce={class:"text-xs text-gray-500 dark:text-gray-400"},me={class:"space-y-4"},be={class:"bg-gray-100 dark:bg-gray-800/50 px-4 py-3 border-b border-gray-200 dark:border-gray-700"},ue={class:"flex items-center justify-between"},ge={class:"font-semibold text-gray-800 dark:text-white/90"},pe=["onClick"],xe={class:"overflow-x-auto"},ye={class:"w-full"},he={class:"bg-gray-50 dark:bg-gray-800/30"},ke={class:"border-r border-gray-200 px-4 py-3 text-center text-xs font-semibold text-gray-700 dark:border-gray-700 dark:text-gray-300"},fe={class:"flex flex-col items-center gap-1"},ve=["onClick"],_e={class:"border-r border-gray-200 px-4 py-3 text-center text-xs font-semibold text-gray-700 dark:border-gray-700 dark:text-gray-300"},we={class:"flex flex-col items-center gap-1"},Ce=["onClick"],$e={class:"border-r border-gray-200 px-4 py-3 text-center text-xs font-semibold text-gray-700 dark:border-gray-700 dark:text-gray-300"},je={class:"flex flex-col items-center gap-1"},Se=["onClick"],Pe={class:"border-r border-gray-200 px-4 py-3 text-center text-xs font-semibold text-gray-700 dark:border-gray-700 dark:text-gray-300"},Ie={class:"flex flex-col items-center gap-1"},Te=["onClick"],Ee={class:"px-4 py-3 text-center text-xs font-semibold text-gray-700 dark:text-gray-300"},Le={class:"flex flex-col items-center gap-1"},Ae=["onClick"],Je={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ke={class:"sticky left-0 z-10 border-r border-gray-200 bg-white px-4 py-3 text-sm font-medium text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"},De={class:"border-r border-gray-200 px-4 py-3 text-center dark:border-gray-700"},Fe=["checked","onChange"],Re={class:"border-r border-gray-200 px-4 py-3 text-center dark:border-gray-700"},qe=["checked","onChange"],Be={class:"border-r border-gray-200 px-4 py-3 text-center dark:border-gray-700"},Ne=["checked","onChange"],He={class:"border-r border-gray-200 px-4 py-3 text-center dark:border-gray-700"},Oe=["checked","onChange"],Xe={class:"px-4 py-3 text-center"},Ve=["checked","onChange"],Ue={class:"flex items-center gap-3 mt-6 lg:justify-end"},Ge=["disabled"],ze=U({__name:"JabatanForm",setup(We){const p=G(),j=z(),b=W(),c=[{name:"Company",subItems:[{name:"Landing Profile",permission:"landing profile"},{name:"Landing Kegiatan",permission:"landing kegiatan"},{name:"Landing Program",permission:"landing program"},{name:"Landing Proposal",permission:"landing proposal"},{name:"Landing Bulletin",permission:"landing bulletin"}]},{name:"Administrasi",subItems:[{name:"Kantor Cabang",permission:"kantor cabang"},{name:"Program",permission:"program"},{name:"Jabatan",permission:"jabatan"},{name:"Pangkat",permission:"pangkat"},{name:"Tipe Absensi",permission:"tipe absensi"},{name:"Gaji",permission:"gaji"},{name:"Tipe Donatur",permission:"tipe donatur"},{name:"Form Pesan",permission:"form pesan"},{name:"SOP",permission:"sop"},{name:"Aturan Kepegawaian",permission:"aturan kepegawaian"}]},{name:"Konten & Publikasi",subItems:[{name:"Program Kami",permission:"program kami"},{name:"Profile Kami",permission:"profile kami"},{name:"Proposal Data",permission:"proposal data"},{name:"Bulletin Data",permission:"bulletin data"}]},{name:"User & Kepegawaian",subItems:[{name:"Karyawan",permission:"karyawan"},{name:"Mitra",permission:"mitra"},{name:"Donatur",permission:"donatur"}]},{name:"Operasional",subItems:[{name:"Absensi",permission:"absensi"},{name:"Remunerasi",permission:"remunerasi"}]},{name:"Keuangan",subItems:[{name:"Keuangan",permission:"keuangan"},{name:"Penyaluran",permission:"penyaluran"},{name:"Pengajuan Dana",permission:"pengajuan dana"}]},{name:"Transaksi",subItems:[{name:"Transaksi",permission:"transaksi"}]},{name:"Laporan",subItems:[{name:"Laporan Transaksi",permission:"laporan transaksi"},{name:"Laporan Keuangan",permission:"laporan keuangan"}]}],x=["view","create","update","show","delete"],d=v(()=>p.params.id!==void 0&&p.params.id!=="new"),A=v(()=>d.value?"Edit Jabatan":"Tambah Jabatan"),y=_(d.value?p.params.id:null),C=_(!1),$=_(""),u=_({name:""}),o=_(new Set),J=v(()=>{if(!$.value)return c;const s=$.value.toLowerCase();return c.map(t=>{const a=t.subItems.filter(r=>r.name.toLowerCase().includes(s)||r.permission.toLowerCase().includes(s)||t.name.toLowerCase().includes(s));return a.length>0||t.name.toLowerCase().includes(s)?{...t,subItems:a.length>0?a:t.subItems}:null}).filter(t=>t!==null)}),K=v(()=>c.reduce((s,t)=>s+t.subItems.length*x.length,0)),D=v(()=>o.value.size),l=s=>o.value.has(s),h=s=>{o.value.has(s)?o.value.delete(s):o.value.add(s)},F=()=>{c.forEach(s=>{s.subItems.forEach(t=>{x.forEach(a=>{o.value.add(`${a} ${t.permission}`)})})})},R=()=>{o.value.clear()},q=s=>{const t=c.find(r=>r.name===s);if(!t)return;const a=t.subItems.every(r=>x.every(n=>l(`${n} ${r.permission}`)));t.subItems.forEach(r=>{x.forEach(n=>{const f=`${n} ${r.permission}`;a?o.value.delete(f):o.value.add(f)})})},B=s=>{const t=c.find(a=>a.name===s);return t?t.subItems.every(a=>x.every(r=>l(`${r} ${a.permission}`))):!1},k=(s,t)=>{const a=c.find(n=>n.name===s);if(!a)return;const r=a.subItems.every(n=>l(`${t} ${n.permission}`));a.subItems.forEach(n=>{const f=`${t} ${n.permission}`;r?o.value.delete(f):o.value.add(f)})},N=async s=>{try{const t=await fetch(`/admin/api/jabatan/${s}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(!t.ok)throw new Error("Failed to fetch");const a=await t.json();a.success&&(u.value.name=a.data.name,o.value=new Set(a.data.permissions||[]))}catch(t){console.error("Error fetching jabatan detail:",t),b.error("Gagal memuat data jabatan")}},H=async()=>{var s;if(!u.value.name.trim()){b.error("Nama jabatan wajib diisi");return}C.value=!0;try{const t=d.value?`/admin/api/jabatan/${y.value}`:"/admin/api/jabatan",a=d.value?"PUT":"POST",r=await fetch(t,{method:a,headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},credentials:"same-origin",body:JSON.stringify({name:u.value.name,permissions:Array.from(o.value)})}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to save");if(n.success)b.success(d.value?"Jabatan berhasil diupdate":"Jabatan berhasil ditambahkan"),j.push("/administrasi/jabatan");else throw new Error(n.message||"Failed to save")}catch(t){console.error("Error saving jabatan:",t),b.error(t.message||"Gagal menyimpan jabatan")}finally{C.value=!1}},O=async()=>{var t;const s=prompt("Masukkan nama untuk jabatan baru:",`${u.value.name} (Copy)`);if(s)try{const r=await(await fetch(`/admin/api/jabatan/${y.value}/clone`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},credentials:"same-origin",body:JSON.stringify({name:s})})).json();if(r.success)b.success("Jabatan berhasil diduplikasi"),j.push("/administrasi/jabatan");else throw new Error(r.message||"Failed to clone")}catch(a){console.error("Error cloning jabatan:",a),b.error(a.message||"Gagal menduplikasi jabatan")}},X=()=>{H()},V=()=>{O()},S=()=>{j.push("/administrasi/jabatan")};return M(async()=>{d.value&&p.params.id&&(y.value=p.params.id,await N(y.value))}),(s,t)=>(g(),Q(ee,null,{default:Y(()=>[e("div",ae,[e("div",re,[e("h3",se,m(A.value),1),e("button",{onClick:S,class:"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]"}," Batal ")]),e("form",{onSubmit:i(X,["prevent"]),class:"flex flex-col"},[e("div",ne,[t[2]||(t[2]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[I(" Nama Jabatan "),e("span",{class:"text-red-500"},"*")],-1)),P(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>u.value.name=a),placeholder:"Masukkan nama jabatan",required:"",maxlength:"100",class:"h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[T,u.value.name]]),t[3]||(t[3]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Maksimal 100 karakter ",-1))]),e("div",oe,[e("div",ie,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400"}," Hak Akses (Permissions) ",-1)),e("div",de,[P(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=a=>$.value=a),placeholder:"Cari menu...",class:"h-9 w-48 rounded-lg border border-gray-300 bg-transparent px-3 py-1.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-2 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[T,$.value]]),d.value&&y.value?(g(),w("button",{key:0,onClick:i(V,["prevent"]),type:"button",class:"flex items-center gap-2 rounded-lg border border-brand-500 bg-transparent px-3 py-1.5 text-sm font-medium text-brand-500 hover:bg-brand-50 dark:border-brand-500 dark:hover:bg-brand-500/10"},[...t[4]||(t[4]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})],-1),I(" Duplikasi ",-1)])])):Z("",!0)])]),e("div",le,[e("button",{onClick:i(F,["prevent"]),type:"button",class:"text-sm font-medium text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Centang Semua "),e("button",{onClick:i(R,["prevent"]),type:"button",class:"text-sm font-medium text-gray-600 hover:text-gray-700 dark:text-gray-400"}," Hapus Semua "),t[6]||(t[6]=e("div",{class:"flex-1"},null,-1)),e("span",ce,m(D.value)+" dari "+m(K.value)+" dipilih ",1)]),e("div",me,[(g(!0),w(E,null,L(J.value,a=>(g(),w("div",{key:a.name,class:"rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},[e("div",be,[e("div",ue,[e("h4",ge,m(a.name),1),e("button",{onClick:i(r=>q(a.name),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"},m(B(a.name)?"Hapus Semua":"Centang Semua"),9,pe)])]),e("div",xe,[e("table",ye,[e("thead",he,[e("tr",null,[t[12]||(t[12]=e("th",{class:"sticky left-0 z-10 min-w-[200px] border-r border-gray-200 bg-gray-50 px-4 py-3 text-left text-sm font-semibold text-gray-700 dark:border-gray-700 dark:bg-gray-800/30 dark:text-gray-300"}," Sub Menu ",-1)),e("th",ke,[e("div",fe,[t[7]||(t[7]=e("span",null,"Lihat",-1)),e("button",{onClick:i(r=>k(a.name,"view"),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Toggle ",8,ve)])]),e("th",_e,[e("div",we,[t[8]||(t[8]=e("span",null,"Buat",-1)),e("button",{onClick:i(r=>k(a.name,"create"),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Toggle ",8,Ce)])]),e("th",$e,[e("div",je,[t[9]||(t[9]=e("span",null,"Ubah",-1)),e("button",{onClick:i(r=>k(a.name,"update"),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Toggle ",8,Se)])]),e("th",Pe,[e("div",Ie,[t[10]||(t[10]=e("span",null,"Detail",-1)),e("button",{onClick:i(r=>k(a.name,"show"),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Toggle ",8,Te)])]),e("th",Ee,[e("div",Le,[t[11]||(t[11]=e("span",null,"Hapus",-1)),e("button",{onClick:i(r=>k(a.name,"delete"),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Toggle ",8,Ae)])])])]),e("tbody",Je,[(g(!0),w(E,null,L(a.subItems,r=>(g(),w("tr",{key:r.permission,class:"hover:bg-gray-50 dark:hover:bg-gray-800/20"},[e("td",Ke,m(r.name),1),e("td",De,[e("input",{type:"checkbox",checked:l(`view ${r.permission}`),onChange:n=>h(`view ${r.permission}`),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-600 dark:bg-gray-800"},null,40,Fe)]),e("td",Re,[e("input",{type:"checkbox",checked:l(`create ${r.permission}`),onChange:n=>h(`create ${r.permission}`),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-600 dark:bg-gray-800"},null,40,qe)]),e("td",Be,[e("input",{type:"checkbox",checked:l(`update ${r.permission}`),onChange:n=>h(`update ${r.permission}`),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-600 dark:bg-gray-800"},null,40,Ne)]),e("td",He,[e("input",{type:"checkbox",checked:l(`show ${r.permission}`),onChange:n=>h(`show ${r.permission}`),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-600 dark:bg-gray-800"},null,40,Oe)]),e("td",Xe,[e("input",{type:"checkbox",checked:l(`delete ${r.permission}`),onChange:n=>h(`delete ${r.permission}`),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-600 dark:bg-gray-800"},null,40,Ve)])]))),128))])])])]))),128))])]),e("div",Ue,[e("button",{onClick:S,type:"button",class:"flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] sm:w-auto"}," Batal "),e("button",{type:"submit",disabled:C.value,class:"flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 disabled:opacity-50 disabled:cursor-not-allowed sm:w-auto"},m(C.value?"Menyimpan...":d.value?"Simpan Perubahan":"Simpan"),9,Ge)])],32)])]),_:1}))}}),Ze=te(ze,[["__scopeId","data-v-bdd33943"]]);export{Ze as default};
