import{g as v,H as P,I as j,N as T,B as _,i as F,J as C,o as S,c as V,a as H,w as M,f as R,b as r,t as x,z as U,j as o,l as N,v as l,n as E,q as O}from"./admin-VbcasAr8.js";import{_ as q}from"./AdminLayout.vue_vue_type_script_setup_true_lang-B03k98HG.js";import{_ as B}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-BudfsEzE.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},$={class:"mb-6 flex items-center justify-between"},G={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},z={class:"grid grid-cols-1 gap-x-6 gap-y-5 lg:grid-cols-2"},D={class:"lg:col-span-2"},J={class:"lg:col-span-1"},L={class:"lg:col-span-1"},A={class:"lg:col-span-1"},I={class:"lg:col-span-1 grid grid-cols-1 gap-x-6 gap-y-5 lg:grid-cols-2"},K={class:"lg:col-span-1"},W={class:"relative z-20 bg-transparent"},Q={class:"lg:col-span-1"},Y={class:"lg:col-span-1"},Z={class:"lg:col-span-1"},ee={class:"lg:col-span-1"},ae={class:"lg:col-span-1"},re={class:"lg:col-span-1"},te=["value"],se={class:"flex items-center gap-3 mt-6 lg:justify-end"},ne={type:"submit",class:"flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 sm:w-auto"},ge=v({__name:"ProgramForm",setup(oe){const g=P(),m=j(),d=T(),i=_(()=>g.params.id!==void 0&&g.params.id!=="new"),h=_(()=>i.value?"Edit Program":"Tambah Program"),e=F({nama_program:"",persentase_hak_program:null,persentase_hak_program_operasional:null,persentase_hak_championship:null,tipe_pembagian_marketing:"",persentase_hak_marketing:null,persentase_hak_operasional_1:null,persentase_hak_iklan:null,persentase_hak_operasional_2:null,persentase_hak_operasional_3:null,jumlah_persentase:null}),k=_(()=>{let s=0;return e.persentase_hak_program!==null&&(s+=e.persentase_hak_program),e.persentase_hak_program_operasional!==null&&(s+=e.persentase_hak_program_operasional),e.persentase_hak_championship!==null&&(s+=e.persentase_hak_championship),e.persentase_hak_marketing!==null&&(s+=e.persentase_hak_marketing),e.persentase_hak_operasional_1!==null&&(s+=e.persentase_hak_operasional_1),e.persentase_hak_iklan!==null&&(s+=e.persentase_hak_iklan),e.persentase_hak_operasional_2!==null&&(s+=e.persentase_hak_operasional_2),e.persentase_hak_operasional_3!==null&&(s+=e.persentase_hak_operasional_3),s>0?parseFloat(s.toFixed(2)):0});C([()=>e.persentase_hak_program,()=>e.persentase_hak_program_operasional,()=>e.persentase_hak_championship,()=>e.tipe_pembagian_marketing,()=>e.persentase_hak_marketing,()=>e.persentase_hak_operasional_1,()=>e.persentase_hak_iklan,()=>e.persentase_hak_operasional_2,()=>e.persentase_hak_operasional_3],()=>{e.jumlah_persentase=k.value},{immediate:!0});const b=async()=>{var s;try{const a=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content");if(a)return a;const t=await fetch("/admin/api/csrf-token",{method:"GET",credentials:"same-origin"});if(!t.ok)throw new Error(`Failed to get CSRF token: ${t.status}`);return(await t.json()).csrf_token||""}catch(a){return console.error("Failed to get CSRF token:",a),""}},y=async()=>{if(i.value&&g.params.id){const s=g.params.id;try{const a=await b(),p=await(await fetch(`/admin/api/program/${s}`,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":a},credentials:"same-origin"})).json();if(p.success&&p.data){const n=p.data;e.nama_program=n.nama_program||"",e.persentase_hak_program=n.persentase_hak_program?parseFloat(n.persentase_hak_program):null,e.persentase_hak_program_operasional=n.persentase_hak_program_operasional?parseFloat(n.persentase_hak_program_operasional):null,e.persentase_hak_championship=n.persentase_hak_championship?parseFloat(n.persentase_hak_championship):null,e.tipe_pembagian_marketing=n.tipe_pembagian_marketing||"",e.persentase_hak_marketing=n.persentase_hak_marketing?parseFloat(n.persentase_hak_marketing):null,e.persentase_hak_operasional_1=n.persentase_hak_operasional_1?parseFloat(n.persentase_hak_operasional_1):null,e.persentase_hak_iklan=n.persentase_hak_iklan?parseFloat(n.persentase_hak_iklan):null,e.persentase_hak_operasional_2=n.persentase_hak_operasional_2?parseFloat(n.persentase_hak_operasional_2):null,e.persentase_hak_operasional_3=n.persentase_hak_operasional_3?parseFloat(n.persentase_hak_operasional_3):null,e.jumlah_persentase=n.jumlah_persentase?parseFloat(n.jumlah_persentase):null}else d.error("Gagal memuat data program"),m.push("/administrasi/program")}catch(a){console.error("Error loading data:",a),d.error("Terjadi kesalahan saat memuat data"),m.push("/administrasi/program")}}},c=()=>{m.push("/administrasi/program")},f=async()=>{if(!e.nama_program){d.error("Nama Program wajib diisi");return}try{const s=await b();if(!s){d.error("Gagal mendapatkan CSRF token. Silakan refresh halaman.");return}const a={nama_program:e.nama_program,persentase_hak_program:e.persentase_hak_program||null,persentase_hak_program_operasional:e.persentase_hak_program_operasional||null,persentase_hak_championship:e.persentase_hak_championship||null,tipe_pembagian_marketing:e.tipe_pembagian_marketing||null,persentase_hak_marketing:e.persentase_hak_marketing||null,persentase_hak_operasional_1:e.persentase_hak_operasional_1||null,persentase_hak_iklan:e.persentase_hak_iklan||null,persentase_hak_operasional_2:e.persentase_hak_operasional_2||null,persentase_hak_operasional_3:e.persentase_hak_operasional_3||null,jumlah_persentase:k.value||null},t=i.value?`/admin/api/program/${g.params.id}`:"/admin/api/program",p=i.value?"PUT":"POST",u=await(await fetch(t,{method:p,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":s},credentials:"same-origin",body:JSON.stringify(a)})).json();if(u.success)d.success(i.value?"Program berhasil diupdate":"Program berhasil ditambahkan"),m.push("/administrasi/program");else if(u.errors){const w=Object.values(u.errors).flat().join(", ");d.error(`Validasi gagal: ${w}`)}else d.error(u.message||"Gagal menyimpan data")}catch(s){console.error("Error saving:",s),d.error("Terjadi kesalahan saat menyimpan data")}};return S(()=>{y()}),(s,a)=>(H(),V(q,null,{default:M(()=>[R(B,{pageTitle:h.value},null,8,["pageTitle"]),r("div",X,[r("div",$,[r("h3",G,x(h.value),1),r("button",{onClick:c,class:"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]"}," Batal ")]),r("form",{onSubmit:U(f,["prevent"]),class:"flex flex-col"},[r("div",z,[r("div",D,[a[10]||(a[10]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[N(" Nama Program "),r("span",{class:"text-red-500"},"*")],-1)),o(r("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=t=>e.nama_program=t),placeholder:"Masukkan nama program",required:"",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.nama_program]])]),r("div",J,[a[11]||(a[11]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Program ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[1]||(a[1]=t=>e.persentase_hak_program=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_program,void 0,{number:!0}]])]),r("div",L,[a[12]||(a[12]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Program Operasional ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=t=>e.persentase_hak_program_operasional=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_program_operasional,void 0,{number:!0}]])]),r("div",A,[a[13]||(a[13]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Championship ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[3]||(a[3]=t=>e.persentase_hak_championship=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_championship,void 0,{number:!0}]])]),r("div",I,[r("div",K,[a[16]||(a[16]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Marketing ",-1)),r("div",W,[o(r("select",{"onUpdate:modelValue":a[4]||(a[4]=t=>e.tipe_pembagian_marketing=t),class:E(["dark:bg-dark-900 h-11 w-full appearance-none rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 pr-11 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",{"text-gray-800 dark:text-white/90":e.tipe_pembagian_marketing}])},[...a[14]||(a[14]=[r("option",{value:"",disabled:"",selected:""},"Pilih Tipe Pembagian",-1),r("option",{value:"percentage",class:"text-gray-700 dark:bg-gray-900 dark:text-gray-400"}," Persentase ",-1),r("option",{value:"nominal",class:"text-gray-700 dark:bg-gray-900 dark:text-gray-400"}," Nominal ",-1)])],2),[[O,e.tipe_pembagian_marketing]]),a[15]||(a[15]=r("span",{class:"absolute z-30 text-gray-500 -translate-y-1/2 pointer-events-none right-4 top-1/2 dark:text-gray-400"},[r("svg",{class:"stroke-current",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[r("path",{d:"M4.79175 7.396L10.0001 12.6043L15.2084 7.396",stroke:"","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})])],-1))])]),r("div",Q,[a[17]||(a[17]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Marketing ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[5]||(a[5]=t=>e.persentase_hak_marketing=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_marketing,void 0,{number:!0}]])])]),r("div",Y,[a[18]||(a[18]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Operasional 1 ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[6]||(a[6]=t=>e.persentase_hak_operasional_1=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_operasional_1,void 0,{number:!0}]])]),r("div",Z,[a[19]||(a[19]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Iklan ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[7]||(a[7]=t=>e.persentase_hak_iklan=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_iklan,void 0,{number:!0}]])]),r("div",ee,[a[20]||(a[20]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Operasional 2 ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[8]||(a[8]=t=>e.persentase_hak_operasional_2=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_operasional_2,void 0,{number:!0}]])]),r("div",ae,[a[21]||(a[21]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Persentase Hak Operasional 3 ",-1)),o(r("input",{type:"number","onUpdate:modelValue":a[9]||(a[9]=t=>e.persentase_hak_operasional_3=t),placeholder:"0",min:"0",max:"100",step:"0.01",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[l,e.persentase_hak_operasional_3,void 0,{number:!0}]])]),r("div",re,[a[22]||(a[22]=r("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Jumlah Persentase ",-1)),r("input",{type:"number",value:k.value,placeholder:"0",min:"0",max:"100",step:"0.01",readonly:"",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-800 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800 cursor-not-allowed opacity-60"},null,8,te),a[23]||(a[23]=r("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Total dari semua persentase ",-1))])]),r("div",se,[r("button",{onClick:c,type:"button",class:"flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] sm:w-auto"}," Batal "),r("button",ne,x(i.value?"Simpan Perubahan":"Simpan"),1)])],32)])]),_:1}))}});export{ge as default};
