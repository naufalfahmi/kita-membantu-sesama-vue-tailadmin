import{d as ke,H as we,I as _e,M as je,A as C,b as f,e as Z,B as ee,f as Ie,V as Se,g as ae,o as i,w as Te,a,t as p,q as De,c as d,i as T,j as P,m as D,k as q,v as B,u as te,F as re,l as se,n as Ce,Q as Ae}from"./admin-BcopZKLz.js";import{C as ne}from"./component-BaQKZHuZ.js";import{_ as Pe,g as Ne}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BX0OUG5C.js";import{S as V}from"./SearchableSelect-BlmxuTzW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Re={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},Ve={class:"mb-6 flex items-center justify-between"},Fe={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},$e={class:"grid grid-cols-1 gap-x-6 gap-y-5 lg:grid-cols-2"},Me={class:"lg:col-span-1"},Ue={class:"lg:col-span-1"},Ee={class:"lg:col-span-1"},Le={class:"flex items-center gap-2"},Oe={class:"flex-1"},qe={key:0,class:"h-11 flex items-center rounded-lg border border-gray-300 bg-gray-50 px-4 text-sm text-gray-500 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400"},Be={class:"lg:col-span-1"},Xe={class:"lg:col-span-1"},He={key:0,class:"h-11 flex items-center rounded-lg border border-gray-300 bg-transparent px-4 text-sm text-gray-700 dark:border-gray-700 dark:text-gray-400"},Ke={key:1,class:"space-y-2"},Ge={class:"flex items-center gap-3"},Ye={key:2},We={class:"lg:col-span-1"},ze={class:"relative"},Je={class:"absolute text-gray-500 -translate-y-1/2 pointer-events-none right-4 top-1/2 dark:text-gray-400 text-sm"},Qe={key:0,class:"mt-1 text-xs text-red-500"},Ze={key:1,class:"mt-1 text-xs text-red-500"},ea={class:"lg:col-span-1"},aa={class:"relative"},ta={class:"lg:col-span-1"},ra={class:"flex items-center gap-2"},sa={key:0,class:"lg:col-span-2"},na={key:0,class:"mt-3 rounded-lg border border-gray-200 bg-gray-50 p-3 text-sm text-gray-700 dark:border-gray-700 dark:bg-gray-900/40"},oa={key:1,class:"mt-3 rounded-lg border border-gray-200 bg-gray-50 p-3 text-sm text-gray-700 dark:border-gray-700 dark:bg-gray-900/40"},la={class:"flex items-center justify-between"},ia={class:"text-lg font-medium"},da={class:"text-right text-xs text-gray-500"},ua={key:0},ga={class:"flex flex-wrap justify-end gap-2"},ma={key:0},pa={key:1},ca={key:1,class:"text-xs"},ya={key:0,class:"mt-3 border-t pt-3"},ba={class:"flex items-center justify-between"},fa={class:"text-xs text-gray-500"},va={key:0},xa={key:1},ha={class:"text-lg font-medium"},ka={class:"text-right text-xs text-gray-500"},wa={class:"mt-3 flex items-center justify-between"},_a={class:"flex items-center gap-3"},ja={class:"mt-3 text-sm text-gray-700"},Ia={class:"font-medium"},Sa={key:0,class:"mt-1 text-xs text-red-500"},Ta={key:0,class:"mt-3 border-t pt-3"},Da={class:"space-y-1 max-h-48 overflow-y-auto"},Ca={class:"font-medium"},Aa={class:"text-gray-600"},Pa={class:"lg:col-span-2"},Na={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ra={class:"flex items-center gap-3 mt-6 lg:justify-end"},Va=["disabled"],Oa=ke({__name:"PengajuanDanaForm",setup(Fa){const F=we(),X=_e(),v=je(),{fetchUser:oe}=Ae(),j=C(()=>F.params.id!==void 0&&F.params.id!=="new"),le=C(()=>j.value?"Edit Pengajuan Dana":"Tambah Pengajuan Dana"),ie={dateFormat:"Y-m-d",altInput:!0,altFormat:"d F Y",locale:"id",wrap:!0,clickOpens:!0,allowInput:!1,minDate:"today"},de={dateFormat:"Y-m-d",mode:"range",altInput:!0,altFormat:"d F Y",locale:"id",wrap:!0,clickOpens:!0,allowInput:!1},N=f([]),I=f([]),$=f([]),M=f([]),H=f(""),K=f(""),G=f(""),E=f(!1),b=f([]),R=f(""),r=Z({applicant:"",submissionType:"",status:"Draft",programId:"",amount:null,usedAt:"",purpose:"",branchId:""}),Y=Z({amount:""}),S=f(!1),U=C(()=>{if(!l||!l.value)return!1;const s=Number(l.value.remaining||0);return Number(r.amount||0)>s}),ue=C(()=>!r.amount||r.amount<=0?"":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r.amount)),l=f(null),x=f(null),A=f(!1);let L=null;const h=s=>!s||s<=0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),ge=s=>{if(!s)return"";try{const e=String(s).split("-");if(e.length<2)return s;const n=Number(e[0]),t=Number(e[1])-1,o=new Date(Date.UTC(n,t,1));return new Intl.DateTimeFormat("id-ID",{month:"long",year:"numeric"}).format(o)}catch{return s}},W=s=>{if(!s)return"";try{const e=String(s).split("-");if(e.length<3)return s;const n=Number(e[0]),t=Number(e[1])-1,o=Number(e[2]),u=new Date(Date.UTC(n,t,o));return new Intl.DateTimeFormat("id-ID",{day:"numeric",month:"long",year:"numeric"}).format(u)}catch{return s}},me=()=>{b.value=[],O()},pe=C(()=>{if(!x.value||!Array.isArray(x.value.shares))return[];const s=I.value.find(u=>u.value===r.submissionType),e=(s==null?void 0:s.share_key)||"program",n=x.value.shares.map(u=>{var m;return{...u,program_share_type_key:u.program_share_type_key??u.type_key??((m=u.type)==null?void 0:m.key)??null}}),t=n.filter(u=>String(u.program_share_type_key)===e);if(t.length>0)return t;const o=n.filter(u=>String(u.program_share_type_key)==="program");return o.length>0?o:n}),O=async()=>{A.value=!0;try{const s=I.value.find(g=>g.value===r.submissionType),e=(s==null?void 0:s.share_key)||"program",n=r.submissionType;let t="",o=null,u=null;const m=g=>{if(!g)return[null,null];if(Array.isArray(g)&&g.length>=2){const c=y=>{if(!y)return null;if(typeof y=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(y))return y;const _=new Date(y);return isNaN(_.getTime())?null:_.toISOString().split("T")[0]};return[c(g[0]),c(g[1])]}if(typeof g=="string"){const c=Array.from(g.matchAll(/(\d{4}-\d{2}-\d{2})/g)).map(_=>_[1]);if(c.length>=2)return[c[0],c[1]];const y=g.split(/[^0-9-]+/).filter(Boolean);if(y.length>=2&&/^\d{4}-\d{2}-\d{2}$/.test(y[0])&&/^\d{4}-\d{2}-\d{2}$/.test(y[1]))return[y[0],y[1]]}try{const c=new Date(g);if(!isNaN(c.getTime())){const y=c.toISOString().split("T")[0];return[y,y]}}catch{}return[null,null]};if(b){const[g,c]=m(b.value);o=g,u=c}if(r.programId)if(o&&u)t=`/admin/api/program/${r.programId}/balance?start_date=${encodeURIComponent(o)}&end_date=${encodeURIComponent(u)}&alias=${encodeURIComponent(n)}`;else{const g=new Date(r.usedAt);if(isNaN(g.getTime())){l.value=null,A.value=!1;return}const c=`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}`;t=`/admin/api/program/${r.programId}/balance?month=${c}&alias=${encodeURIComponent(n)}&lookback=1`}else if(o&&u)t=`/admin/api/programs/aggregate-balance?start_date=${encodeURIComponent(o)}&end_date=${encodeURIComponent(u)}&alias=${encodeURIComponent(n)}`;else{const g=new Date(r.usedAt);if(isNaN(g.getTime())){l.value=null,A.value=!1;return}t=`/admin/api/programs/aggregate-balance?month=${`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}`}&alias=${encodeURIComponent(n)}`}const k=await(await fetch(t,{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}})).json();if(!k.success)throw new Error(k.message||"Failed to load balance");o&&u&&(k.data||(k.data={}),k.data.start_date||(k.data.start_date=o),k.data.end_date||(k.data.end_date=u)),l.value=k.data}catch(s){console.error("Error loading program balance",s),v.error("Gagal memuat saldo program"),l.value=null}finally{A.value=!1}},z=async()=>{if(!r.programId){x.value={nama_program:"Semua Program",shares:[]};return}try{const e=await(await fetch(`/admin/api/program/${r.programId}`,{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}})).json();if(!e.success)throw new Error(e.message||"Failed to load program");x.value=e.data}catch(s){console.error("Error loading program detail",s),x.value=null}},ce=async()=>{try{const e=await(await fetch("/admin/api/program-share-types/submission-types",{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}})).json();e.success&&Array.isArray(e.data)?I.value=e.data.map(n=>({value:n.value,label:n.value,share_key:n.share_key,name:n.name})):I.value=[{value:"Program",label:"Program",share_key:"program"},{value:"Operasional",label:"Operasional",share_key:"ops_2"},{value:"Gaji Karyawan",label:"Gaji Karyawan",share_key:"ops_1"}]}catch(s){console.error("Error fetching submission types",s),I.value=[{value:"Program",label:"Program",share_key:"program"},{value:"Operasional",label:"Operasional",share_key:"ops_2"},{value:"Gaji Karyawan",label:"Gaji Karyawan",share_key:"ops_1"}]}};ee([()=>r.programId,()=>r.usedAt,()=>b.value],()=>{L&&window.clearTimeout(L),L=window.setTimeout(()=>{z(),O()},300)}),ee(()=>r.submissionType,s=>{const e=String(s);j.value||(r.amount=null),I.value.some(n=>n.value===e)?(z(),O()):(x.value=null,l.value=null)});const ye=s=>{const e=s.target,n=parseFloat(e.value);isNaN(n)||n<0?r.amount=null:r.amount=Math.floor(n)},be=async()=>{if(!j.value)return;const s=F.params.id;try{const n=await(await fetch(`/admin/api/pengajuan-dana/${s}`,{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}})).json();if(!n.success)throw new Error(n.message||"Failed to load");const t=n.data;if(r.applicant=t.fundraiser?String(t.fundraiser.id):"",r.status=t.status||"Draft",t.fundraiser&&!N.value.find(o=>o.value===String(t.fundraiser.id))&&N.value.unshift({value:String(t.fundraiser.id),label:t.fundraiser.name||t.fundraiser.nama||""}),r.submissionType=t.submission_type,t.submission_type&&!I.value.find(o=>o.value===t.submission_type)&&I.value.unshift({value:t.submission_type,label:t.submission_type,share_key:""}),r.amount=t.amount,t.used_at){const o=String(t.used_at).split(" ")[0];r.usedAt=o}if(r.purpose=t.purpose||"",r.branchId=t.kantor_cabang?t.kantor_cabang.id:"",r.programId=t.program?String(t.program.id):"",t.kantor_cabang&&!$.value.find(o=>o.value===String(t.kantor_cabang.id))&&$.value.unshift({value:String(t.kantor_cabang.id),label:t.kantor_cabang.nama||""}),t.program&&!M.value.find(o=>o.value===String(t.program.id))){const o=t.program.nama_program||t.program.nama||"";M.value.unshift({value:String(t.program.id),label:o})}}catch(e){console.error("Error loading data:",e),v.error("Gagal memuat data pengajuan dana")}},fe=async()=>{E.value=!0;try{const s=await oe();R.value=s!=null&&s.id?String(s.id):"";const n=await(await fetch("/admin/api/pengajuan-dana/options",{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}})).json();if(!n.success)throw new Error(n.message||"Failed to load options");const t=n.data.users||[];N.value=t.map(m=>({value:String(m.id),label:m.name}));const o=n.data.kantor_cabangs||[];$.value=o.map(m=>({value:String(m.id),label:m.nama}));const u=n.data.programs||[];M.value=u.map(m=>({value:String(m.id),label:m.nama})),R.value&&N.value.find(w=>w.value===String(R.value))&&!r.applicant&&(r.applicant=String(R.value)),j.value&&n.data&&n.data.current&&n.data.current.program&&(r.programId=String(n.data.current.program.id))}catch(s){console.error("Error loading options",s),v.error("Gagal memuat opsi form")}finally{E.value=!1}},ve=[{value:"Draft",label:"Draft"},{value:"Pending",label:"Diajukan"}];C(()=>String(r.applicant)===String(R.value));const xe=C(()=>ve),J=()=>X.push("/keuangan/pengajuan-dana"),he=async()=>{var s;if(!r.applicant){v.error("Pengaju wajib diisi");return}if(!r.submissionType){v.error("Tipe Pengajuan wajib diisi");return}if(!r.amount||r.amount<=0){v.error("Nominal wajib diisi dan harus lebih dari 0");return}if(!r.usedAt){v.error("Tanggal Digunakan wajib diisi");return}if(!r.branchId){v.error("Kantor Cabang wajib diisi");return}if(!S.value){S.value=!0;try{if(U.value){const w=h(Number(((s=l.value)==null?void 0:s.remaining)||0));v.error(`nominal melebihi batas tidak dapat menyimpan — sisa alokasi: ${w}`),S.value=!1;return}const e={fundraiser_id:r.applicant,submission_type:r.submissionType,program_id:r.programId||null,status:r.status,amount:r.amount,used_at:r.usedAt,purpose:r.purpose,kantor_cabang_id:r.branchId};if(b&&Array.isArray(b.value)&&b.value.length>=2){const w=_=>{if(!_)return null;if(typeof _=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(_))return _;const Q=new Date(_);return isNaN(Q.getTime())?null:Q.toISOString().split("T")[0]},[k,g]=b.value,c=w(k),y=w(g);c&&y&&(e.start_date=c,e.end_date=y)}const n=await Ne(),t=j.value?`/admin/api/pengajuan-dana/${F.params.id}`:"/admin/api/pengajuan-dana",o=j.value?"PUT":"POST",m=await(await fetch(t,{method:o,credentials:"same-origin",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e)})).json();if(!m.success){if(m.remaining!==void 0){v.error(`nominal melebihi batas tidak dapat menyimpan — sisa alokasi: ${h(Number(m.remaining))}`),S.value=!1;return}if(m.errors){const w=Object.values(m.errors)[0];v.error(w?String(w[0]):"Validation failed"),S.value=!1;return}throw new Error(m.message||"Failed to save")}v.success(j.value?"Pengajuan dana berhasil diupdate":"Pengajuan dana berhasil ditambahkan"),X.push("/keuangan/pengajuan-dana")}catch(e){console.error("Error saving:",e),v.error("Terjadi kesalahan saat menyimpan data")}finally{S.value=!1}}};return Ie(async()=>{if(await ce(),await fe(),await Se(),j.value)await be();else{const s=new Date().toISOString().split("T")[0];(!r.usedAt||String(r.usedAt).trim()==="")&&(r.usedAt=s)}}),(s,e)=>(i(),ae(Pe,null,{default:Te(()=>{var n;return[a("div",Re,[a("div",Ve,[a("h3",Fe,p(le.value),1),a("button",{onClick:J,class:"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]"},"Batal")]),a("form",{onSubmit:De(he,["prevent"]),class:"flex flex-col"},[a("div",$e,[a("div",Me,[e[17]||(e[17]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[D("Pengaju "),a("span",{class:"text-red-500"},"*")],-1)),P(V,{modelValue:r.applicant,"onUpdate:modelValue":e[0]||(e[0]=t=>r.applicant=t),options:N.value,placeholder:"Pilih atau cari pengaju","search-input":H.value,"onUpdate:searchInput":e[1]||(e[1]=t=>H.value=t)},null,8,["modelValue","options","search-input"])]),a("div",Ue,[e[18]||(e[18]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[D("Tipe Pengajuan "),a("span",{class:"text-red-500"},"*")],-1)),P(V,{modelValue:r.submissionType,"onUpdate:modelValue":e[2]||(e[2]=t=>r.submissionType=t),options:I.value,placeholder:"Pilih tipe pengajuan","search-input":K.value,"onUpdate:searchInput":e[3]||(e[3]=t=>K.value=t)},null,8,["modelValue","options","search-input"])]),a("div",Ee,[e[21]||(e[21]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},"Program",-1)),a("div",Le,[a("div",Oe,[E.value?(i(),d("div",qe,[...e[19]||(e[19]=[a("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-gray-500 dark:text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),D(" Memuat data program... ",-1)])])):(i(),ae(V,{key:1,modelValue:r.programId,"onUpdate:modelValue":e[4]||(e[4]=t=>r.programId=t),options:M.value,placeholder:"Pilih program"},null,8,["modelValue","options"]))]),r.programId?(i(),d("button",{key:0,type:"button",title:"Hapus pilihan program",onClick:e[5]||(e[5]=t=>r.programId=""),class:"h-11 w-11 flex items-center justify-center rounded-lg border border-gray-300 bg-white text-sm text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"},[...e[20]||(e[20]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:"M18 6L6 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),a("path",{d:"M6 6L18 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):T("",!0)])]),a("div",Be,[e[22]||(e[22]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[D("Kantor "),a("span",{class:"text-red-500"},"*")],-1)),P(V,{modelValue:r.branchId,"onUpdate:modelValue":e[6]||(e[6]=t=>r.branchId=t),options:$.value,placeholder:"Pilih atau cari kantor cabang","search-input":G.value,"onUpdate:searchInput":e[7]||(e[7]=t=>G.value=t)},null,8,["modelValue","options","search-input"])]),a("div",Xe,[e[25]||(e[25]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[D("Status "),a("span",{class:"text-red-500"},"*")],-1)),r.status==="Approved"?(i(),d("div",He,[e[23]||(e[23]=a("span",{class:"flex-1"},"Disetujui",-1)),q(a("input",{type:"hidden","onUpdate:modelValue":e[8]||(e[8]=t=>r.status=t)},null,512),[[B,r.status]])])):r.status==="Rejected"?(i(),d("div",Ke,[e[24]||(e[24]=a("div",{class:"rounded-lg border border-red-200 bg-red-50 p-3 text-sm text-red-700 dark:border-red-800 dark:bg-red-900/10 dark:text-red-300"},[a("div",{class:"font-medium"},"Pengajuan ditolak"),a("div",{class:"text-xs"},"Anda dapat mengajukan ulang jika diperlukan.")],-1)),a("div",Ge,[a("button",{type:"button",onClick:e[9]||(e[9]=()=>{r.status="Pending"}),class:"rounded bg-brand-500 px-3 py-1 text-sm text-white"},"Ajukan lagi"),a("button",{type:"button",onClick:e[10]||(e[10]=()=>{r.status="Draft"}),class:"rounded bg-gray-100 px-3 py-1 text-sm"},"Simpan sebagai Draft")])])):(i(),d("div",Ye,[P(V,{modelValue:r.status,"onUpdate:modelValue":e[11]||(e[11]=t=>r.status=t),options:xe.value,placeholder:"Pilih status"},null,8,["modelValue","options"])]))]),a("div",We,[e[26]||(e[26]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[D("Nominal "),a("span",{class:"text-red-500"},"*")],-1)),a("div",ze,[q(a("input",{type:"number","onUpdate:modelValue":e[12]||(e[12]=t=>r.amount=t),placeholder:"Masukkan nominal",min:"1",step:"1",required:"",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 pr-24 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",onInput:ye},null,544),[[B,r.amount,void 0,{number:!0}]]),a("span",Je,p(ue.value),1)]),e[27]||(e[27]=a("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},"Minimal nominal: Rp 1",-1)),U.value?(i(),d("p",Qe,"Nominal melebihi sisa alokasi: "+p(h(((n=l.value)==null?void 0:n.remaining)||0)),1)):Y.amount?(i(),d("p",Ze,p(Y.amount),1)):T("",!0)]),a("div",ea,[e[28]||(e[28]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[D("Tanggal Digunakan "),a("span",{class:"text-red-500"},"*")],-1)),a("div",aa,[P(te(ne),{modelValue:r.usedAt,"onUpdate:modelValue":e[13]||(e[13]=t=>r.usedAt=t),config:ie,class:"dark:bg-dark-900 h-11 w-full appearance-none rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 pl-4 pr-11 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",placeholder:"Pilih tanggal digunakan",required:""},null,8,["modelValue"])])]),a("div",ta,[e[30]||(e[30]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},"Rentang Tanggal Transaksi (opsional)",-1)),a("div",ra,[P(te(ne),{modelValue:b.value,"onUpdate:modelValue":e[14]||(e[14]=t=>b.value=t),config:de,class:"dark:bg-dark-900 h-10 flex-1 appearance-none rounded-lg border border-gray-300 bg-transparent px-3 py-2 text-sm text-gray-800 placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90",placeholder:"Pilih rentang tanggal"},null,8,["modelValue"]),Array.isArray(b.value)&&b.value.length>0||b.value&&String(b.value).length>0?(i(),d("button",{key:0,type:"button",title:"Hapus Leader",onClick:me,class:"h-10 w-10 flex items-center justify-center rounded-lg border border-gray-300 bg-white text-sm text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300"},[...e[29]||(e[29]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:"M18 6L6 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),a("path",{d:"M6 6L18 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])):T("",!0)])]),x.value||A.value?(i(),d("div",sa,[A.value?(i(),d("div",na,[...e[31]||(e[31]=[a("div",{class:"flex items-center justify-center py-8"},[a("svg",{class:"animate-spin h-8 w-8 text-brand-500 dark:text-brand-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),a("span",{class:"ml-3 text-gray-600 dark:text-gray-400"},"Memuat detail program...")],-1)])])):x.value?(i(),d("div",oa,[a("div",la,[a("div",null,[e[32]||(e[32]=a("div",{class:"text-xs text-gray-500"},"Program",-1)),a("div",ia,p(x.value.nama_program||x.value.nama||""),1)]),a("div",da,[x.value&&Array.isArray(x.value.shares)?(i(),d("div",ua,[a("div",ga,[(i(!0),d(re,null,se(pe.value,t=>(i(),d("span",{key:t.id||t.share_id||t.program_share_id,class:"inline-flex items-center rounded px-2 py-0.5 bg-gray-100 text-xs text-gray-700 dark:bg-gray-800/40 dark:text-gray-300"},[t.type==="percentage"||t.type_key&&String(t.type_key).toLowerCase().includes("percent")?(i(),d("span",ma,p(Number(t.value||0))+"% ",1)):(i(),d("span",pa,p(h(Number(t.value||0))),1))]))),128))])])):(i(),d("div",ca," "))])]),l.value?(i(),d("div",ya,[a("div",ba,[a("div",null,[a("div",fa,[l.value.start_date&&l.value.end_date?(i(),d("span",va,"Sisa alokasi "+p(W(l.value.start_date))+" - "+p(W(l.value.end_date)),1)):(i(),d("span",xa,"Sisa alokasi bulan "+p(ge(l.value.month)),1))]),a("div",ha,p(h(l.value.remaining)),1)]),a("div",ka,[a("div",null,"Inflow: "+p(h(l.value.inflow)),1),a("div",null,"Dialokasikan: "+p(h(l.value.allocated)),1),a("div",null,"Terpakai: "+p(h(l.value.outflow)),1)])]),a("div",wa,[e[33]||(e[33]=a("div",{class:"text-sm text-gray-600"},"Opsi:",-1)),a("div",_a,[a("button",{type:"button",onClick:e[15]||(e[15]=()=>{r.amount=l.value.remaining}),class:"rounded bg-gray-100 px-3 py-1 text-sm"},"Gunakan Seluruh Alokasi")])]),a("div",ja,[a("div",null,[e[34]||(e[34]=D("Estimasi sisa setelah pengajuan: ",-1)),a("span",Ia,p(h((l.value.remaining||0)-(r.amount||0))),1)]),(r.amount||0)>(l.value.remaining||0)?(i(),d("div",Sa,"Kekurangan: "+p(h((r.amount||0)-(l.value.remaining||0))),1)):T("",!0)]),l.value.program_breakdown&&l.value.program_breakdown.length>0?(i(),d("div",Ta,[e[35]||(e[35]=a("div",{class:"text-sm font-medium text-gray-700 mb-2"},"Detail Program:",-1)),a("div",Da,[(i(!0),d(re,null,se(l.value.program_breakdown,t=>(i(),d("div",{key:t.program_id,class:"flex items-center justify-between text-xs bg-gray-50 dark:bg-gray-800/20 rounded px-2 py-1"},[a("div",Ca,p(t.program_name),1),a("div",Aa,p(h(t.remaining)),1)]))),128))])])):T("",!0)])):T("",!0)])):T("",!0)])):T("",!0),a("div",Pa,[e[36]||(e[36]=a("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},"Tujuan Pengajuan",-1)),q(a("textarea",{"onUpdate:modelValue":e[16]||(e[16]=t=>r.purpose=t),placeholder:"Masukkan tujuan atau alasan pengajuan dana",maxlength:"1000",rows:"4",class:"dark:bg-dark-900 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[B,r.purpose]]),a("p",Na,p(r.purpose.length)+"/1000 karakter",1)])]),a("div",Ra,[a("button",{onClick:J,type:"button",class:"flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] sm:w-auto"},"Batal"),a("button",{disabled:S.value||U.value,type:"submit",class:Ce(["flex w-full justify-center rounded-lg px-4 py-2.5 text-sm font-medium sm:w-auto",S.value||U.value?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-brand-500 text-white hover:bg-brand-600"])},p(j.value?"Simpan Perubahan":"Simpan"),11,Va)])],32)])]}),_:1}))}});export{Oa as default};
