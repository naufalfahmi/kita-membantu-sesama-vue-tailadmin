import{d as v,I as w,M as k,b as c,f as _,B as N,A as u,g as S,o as m,w as j,a as s,k as C,c as D,F as R,l as B,t as p,P as E,j as $,u as G,S as L}from"./admin-DMZYkn2X.js";import{_ as T}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CLsIF66K.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},A={class:"mb-6 flex items-center justify-between"},M={class:"flex items-center gap-3"},V=["value"],z={class:"ag-theme-alpine",style:{width:"100%","min-height":"300px"}},F={class:"fixed right-6 bottom-6 z-50"},Y={class:"flex items-center gap-3 px-4 py-3 rounded-lg text-white bg-brand-500 hover:bg-brand-600 shadow-lg"},I={class:"text-lg font-semibold"},O=v({__name:"PayrollMine",setup(H){const g=w(),l=k(),o=c([]),f={resizable:!0,sortable:!0},x=new Date().getFullYear(),i=[];for(let a=0;a<5;a++)i.push(x-a);const n=c(""),d=async()=>{try{const a=`/admin/api/operasional/payroll/me/list${n.value?"?year="+n.value:""}`,e=await fetch(a,{credentials:"same-origin"}),t=await e.json();e.ok&&t.success?o.value=t.data:l.error(t.message||"Gagal mengambil data slip")}catch{l.error("Gagal mengambil slip gaji")}};_(d),N(n,()=>{d()});const h=u(()=>o.value.reduce((a,e)=>a+(Number(e.total)||0),0)),b=u(()=>h.value.toLocaleString()),y=[{headerName:"Periode",field:"period_label",flex:1},{headerName:"Status",field:"status",width:150,cellRenderer:a=>{const e={pending:"Pending",locked:"Selesai",transferred:"Ditransfer"},t={pending:"bg-yellow-100 text-yellow-800",locked:"bg-green-100 text-green-800",transferred:"bg-blue-100 text-blue-800"},r=document.createElement("span");return r.className=`inline-block rounded-full px-3 py-1 text-xs font-medium ${t[a.value]||"bg-gray-100 text-gray-800"}`,r.textContent=e[a.value]||a.value||"",r}},{headerName:"Total",field:"total",width:160,cellRenderer:a=>{const e=document.createElement("span");return e.className="text-sm font-medium text-gray-800",e.textContent=a.value?`Rp ${a.value.toLocaleString()}`:"Rp 0",e}},{headerName:"Bukti",field:"transfer_proof",width:140,cellRenderer:a=>{const e=document.createElement("div");if(a.data&&a.data.transfer_proof){const t=document.createElement("a");t.href=`/storage/${a.data.transfer_proof}`,t.target="_blank",t.className="text-sm text-brand-500 hover:underline",t.textContent="Lihat Bukti",e.appendChild(t)}else{const t=document.createElement("span");t.className="text-sm text-gray-500",t.textContent="â€”",e.appendChild(t)}return e}},{headerName:"Actions",field:"actions",width:160,cellStyle:{display:"flex",justifyContent:"center",alignItems:"center"},cellRenderer:a=>{const e=document.createElement("div");e.className="flex items-center justify-center gap-3";const t=document.createElement("button");return t.className="flex items-center justify-center px-3 py-1 rounded-lg text-white bg-brand-500 hover:bg-brand-600 text-sm",t.innerText="Cetak Slip",t.onclick=async()=>{try{(await(await fetch("/admin/api/debug-auth",{credentials:"same-origin"})).json()).authenticated?window.open(`/admin/operasional/payroll/periods/${a.data.period_id}/records/${a.data.id}/slip?format=pdf`,"_blank"):(l.error("Sesi kadaluarsa, silakan masuk kembali"),g.push("/signin"))}catch{l.error("Gagal memeriksa status autentikasi")}},e.appendChild(t),e}}];return(a,e)=>(m(),S(T,null,{default:j(()=>[s("div",P,[s("div",A,[e[3]||(e[3]=s("h3",{class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},"Slip Gaji Saya",-1)),s("div",M,[e[2]||(e[2]=s("label",{class:"text-sm text-gray-500"},"Tahun",-1)),C(s("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>n.value=t),class:"border rounded-md px-3 py-1 text-sm"},[e[1]||(e[1]=s("option",{value:""},"Semua",-1)),(m(),D(R,null,B(i,t=>s("option",{key:t,value:t},p(t),9,V)),64))],512),[[E,n.value]])])]),s("div",z,[$(G(L),{class:"ag-theme-alpine",style:{width:"100%","min-height":"300px"},columnDefs:y,rowData:o.value,defaultColDef:f,pagination:!0,paginationPageSize:20,animateRows:!0,domLayout:"autoHeight"},null,8,["rowData"])])]),s("div",F,[s("button",Y,[e[4]||(e[4]=s("span",{class:"text-sm"},"Total Gaji",-1)),s("span",I,"Rp "+p(b.value),1)])])]),_:1}))}});export{O as default};
