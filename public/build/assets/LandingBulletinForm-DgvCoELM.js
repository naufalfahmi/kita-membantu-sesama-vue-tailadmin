import{g as H,H as q,I as A,r as k,B as F,i as L,o as X,c as $,a as g,w as G,f as T,b as e,t as n,z as I,j as B,d as c,e as p,l as v,v as P,u as W,q as K}from"./admin-CLxYwY0g.js";import{C as Y}from"./component-BgD9IQUg.js";import{_ as J}from"./AdminLayout.vue_vue_type_script_setup_true_lang-B648_P3o.js";import{_ as Q}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-Z11cfszT.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},ee={class:"mb-6 flex items-center justify-between"},te={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},ae={class:"grid grid-cols-1 gap-x-6 gap-y-5 lg:grid-cols-2"},re={class:"lg:col-span-2"},le={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},se={key:0,class:"mt-1 text-xs text-red-500"},ie={class:"lg:col-span-2"},oe={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},ne={key:0,class:"mt-1 text-xs text-red-500"},de={class:"lg:col-span-1"},ue={key:0,class:"mt-1 text-xs text-red-500"},ge={class:"lg:col-span-1"},ce={key:0,class:"mt-1 text-xs text-red-500"},pe={class:"lg:col-span-2"},be={class:"space-y-4"},me={key:0,class:"space-y-2"},fe={key:0,class:"space-y-3"},xe={class:"flex items-center gap-3 rounded-lg border border-gray-300 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800"},ye={class:"flex-1 min-w-0"},he={class:"text-sm font-medium text-gray-800 dark:text-white/90 truncate"},ke={class:"text-xs text-gray-500 dark:text-gray-400"},ve={class:"flex items-center gap-2"},_e=["href"],we={key:0,class:"rounded-lg border border-gray-300 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 overflow-hidden"},Be={class:"p-2",style:{height:"600px"}},je=["src"],Me={key:1,class:"space-y-3"},Ce={class:"flex items-center gap-3 rounded-lg border border-gray-300 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800"},Fe={class:"flex-1 min-w-0"},Le={class:"text-sm font-medium text-gray-800 dark:text-white/90 truncate"},Te={class:"text-xs text-gray-500 dark:text-gray-400"},Pe={key:0,class:"rounded-lg border border-gray-300 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 overflow-hidden"},Re={class:"p-2",style:{height:"600px"}},Ue=["src"],De={key:0,class:"mt-1 text-xs text-red-500"},ze={class:"flex items-center gap-3 mt-6 lg:justify-end"},Se=["disabled"],Ae=H({__name:"LandingBulletinForm",setup(Oe){const h=q(),_=A(),m=k(null),x=F(()=>h.params.id!==void 0&&h.params.id!=="new"),j=F(()=>x.value?"Edit Landing Bulletin":"Tambah Landing Bulletin"),y=k(!1),R={dateFormat:"Y-m-d",locale:{firstDayOfWeek:1}},a=L({name:"",slug:"",bulletin_date:"",is_published:!0}),l=L({name:"",slug:"",bulletin_date:"",file:"",is_published:""}),d=k(null),b=k(""),o=k(null),w=()=>{if(!a.name)return"";const r=a.name.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"");return(!x.value||!a.slug)&&(a.slug=r),r},M=r=>{if(r===0)return"0 Bytes";const t=1024,i=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(r)/Math.log(t));return Math.round(r/Math.pow(t,s)*100)/100+" "+i[s]},U=r=>{var i;const t=r.target;if(t.files&&t.files.length>0){const s=t.files[0],u=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],f=[".pdf",".doc",".docx"],E="."+((i=s.name.split(".").pop())==null?void 0:i.toLowerCase());if(!u.includes(s.type)&&!f.includes(E)){l.file="Format file tidak didukung. Hanya PDF, DOC, dan DOCX yang diizinkan.",m.value&&(m.value.value="");return}const N=20*1024*1024;if(s.size>N){l.file="Ukuran file melebihi 20MB. Mohon pilih file yang lebih kecil.",m.value&&(m.value.value="");return}l.file="",d.value=s,o.value=null,s.type==="application/pdf"?b.value=URL.createObjectURL(s):b.value="",m.value&&(m.value.value="")}},D=()=>{b.value&&URL.revokeObjectURL(b.value),d.value=null,b.value="",m.value&&(m.value.value=""),l.file=""},z=()=>{o.value=null,l.file=""},S=()=>{let r=!0;if(Object.keys(l).forEach(t=>{l[t]=""}),!a.name||a.name.trim()===""?(l.name="Nama bulletin wajib diisi",r=!1):a.name.length>100&&(l.name="Nama bulletin maksimal 100 karakter",r=!1),!a.bulletin_date)l.bulletin_date="Tanggal bulletin wajib diisi",r=!1;else{const t=new Date(a.bulletin_date);isNaN(t.getTime())&&(l.bulletin_date="Format tanggal tidak valid",r=!1)}return!d.value&&!o.value&&(l.file="File bulletin wajib diupload",r=!1),!a.slug&&a.name&&w(),r},O=async()=>{if(x.value&&h.params.id){const r=h.params.id;y.value=!0;try{const i=await(await fetch(`/admin/api/landing-bulletin/${r}`,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"same-origin"})).json();if(i.success&&i.data){const s=i.data;if(a.name=s.name||"",a.slug=s.slug||"",a.bulletin_date=s.bulletin_date||"",a.is_published=s.is_published!==void 0?s.is_published:!0,s.file){const u=s.file_url||s.file,f=u.toLowerCase().endsWith(".pdf")||s.file_type==="application/pdf";o.value={name:s.file_name||"File Bulletin",url:u,size:s.file_size||void 0,isPdf:f}}}else alert(i.message||"Gagal memuat data"),_.push("/company/landing-bulletin")}catch(t){console.error("Error loading data:",t),alert("Terjadi kesalahan saat memuat data"),_.push("/company/landing-bulletin")}finally{y.value=!1}}else a.is_published=!0},C=()=>{b.value&&URL.revokeObjectURL(b.value),_.push("/company/landing-bulletin")},V=async()=>{if(S()){y.value=!0;try{const r=new FormData;!a.slug&&a.name&&(a.slug=w()),r.append("name",a.name),r.append("slug",a.slug||""),r.append("bulletin_date",a.bulletin_date),r.append("is_published",a.is_published?"1":"0"),d.value&&r.append("file",d.value);const t=x.value?`/admin/api/landing-bulletin/${h.params.id}`:"/admin/api/landing-bulletin",i=x.value?"PUT":"POST",u=await(await fetch(t,{method:i,headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"same-origin",body:r})).json();u.success?(b.value&&URL.revokeObjectURL(b.value),alert(x.value?"Bulletin berhasil diupdate":"Bulletin berhasil ditambahkan"),_.push("/company/landing-bulletin")):(u.errors&&Object.keys(u.errors).forEach(f=>{l.hasOwnProperty(f)&&(l[f]=Array.isArray(u.errors[f])?u.errors[f][0]:u.errors[f])}),alert(u.message||"Gagal menyimpan data"))}catch(r){console.error("Error saving:",r),alert("Terjadi kesalahan saat menyimpan data")}finally{y.value=!1}}};return X(()=>{O()}),(r,t)=>(g(),$(J,null,{default:G(()=>[T(Q,{pageTitle:j.value},null,8,["pageTitle"]),e("div",Z,[e("div",ee,[e("h3",te,n(j.value),1),e("button",{onClick:C,class:"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]"}," Batal ")]),e("form",{onSubmit:I(V,["prevent"]),class:"flex flex-col"},[e("div",ae,[e("div",re,[t[4]||(t[4]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[v(" Nama Bulletin "),e("span",{class:"text-red-500"},"*")],-1)),B(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>a.name=i),onInput:w,placeholder:"Masukkan nama bulletin",maxlength:"100",required:"",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,544),[[P,a.name]]),e("p",le,n(a.name.length)+"/100 karakter ",1),l.name?(g(),c("p",se,n(l.name),1)):p("",!0)]),e("div",ie,[t[5]||(t[5]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[v(" Slug (URL) "),e("span",{class:"text-xs text-gray-500"},"(Otomatis di-generate dari nama bulletin)")],-1)),B(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=i=>a.slug=i),placeholder:"Slug akan otomatis dibuat dari nama bulletin",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm text-gray-600 shadow-theme-xs placeholder:text-gray-400 cursor-not-allowed dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400",readonly:""},null,512),[[P,a.slug]]),e("p",oe," URL-friendly: "+n(a.slug||"akan dibuat otomatis"),1),l.slug?(g(),c("p",ne,n(l.slug),1)):p("",!0)]),e("div",de,[t[6]||(t[6]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[v(" Tanggal Bulletin "),e("span",{class:"text-red-500"},"*")],-1)),T(W(Y),{modelValue:a.bulletin_date,"onUpdate:modelValue":t[2]||(t[2]=i=>a.bulletin_date=i),config:R,class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",placeholder:"Pilih tanggal bulletin"},null,8,["modelValue"]),l.bulletin_date?(g(),c("p",ue,n(l.bulletin_date),1)):p("",!0)]),e("div",ge,[t[8]||(t[8]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Status Publish ",-1)),B(e("select",{"onUpdate:modelValue":t[3]||(t[3]=i=>a.is_published=i),class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800"},[...t[7]||(t[7]=[e("option",{value:!0},"Published (Tampil di Landing)",-1),e("option",{value:!1},"Draft (Tidak Tampil)",-1)])],512),[[K,a.is_published]]),t[9]||(t[9]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Kontrol apakah bulletin ditampilkan di halaman landing ",-1)),l.is_published?(g(),c("p",ce,n(l.is_published),1)):p("",!0)]),e("div",pe,[t[18]||(t[18]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[v(" File Bulletin "),e("span",{class:"text-red-500"},"*")],-1)),e("div",be,[e("div",null,[e("input",{ref_key:"fileInputRef",ref:m,type:"file",accept:".pdf,.doc,.docx",onChange:U,class:"dark:bg-dark-900 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800"},null,544),t[10]||(t[10]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Format: PDF, DOC, DOCX. Maksimal 20MB. Hanya 1 file per bulletin. ",-1))]),d.value||o.value?(g(),c("div",me,[o.value&&!d.value?(g(),c("div",fe,[e("div",xe,[t[13]||(t[13]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-10 w-10 text-brand-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})])],-1)),e("div",ye,[e("p",he,n(o.value.name||"File Bulletin"),1),e("p",ke,n(o.value.size?M(o.value.size):""),1)]),e("div",ve,[o.value.url?(g(),c("a",{key:0,href:o.value.url,target:"_blank",class:"flex items-center gap-1 rounded-lg bg-brand-500 px-3 py-1.5 text-xs font-medium text-white hover:bg-brand-600"},[...t[11]||(t[11]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),v(" Lihat ",-1)])],8,_e)):p("",!0),e("button",{type:"button",onClick:z,class:"flex items-center justify-center w-8 h-8 rounded-lg text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 transition-colors"},[...t[12]||(t[12]=[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])])]),o.value.isPdf&&o.value.url?(g(),c("div",we,[t[14]||(t[14]=e("div",{class:"bg-gray-100 dark:bg-gray-900 px-4 py-2 border-b border-gray-300 dark:border-gray-700"},[e("p",{class:"text-sm font-medium text-gray-700 dark:text-gray-400"},"Preview PDF")],-1)),e("div",Be,[e("iframe",{src:o.value.url,class:"w-full h-full border-0 rounded",type:"application/pdf"},null,8,je)])])):p("",!0)])):p("",!0),d.value?(g(),c("div",Me,[e("div",Ce,[t[16]||(t[16]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-10 w-10 text-brand-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})])],-1)),e("div",Fe,[e("p",Le,n(d.value.name),1),e("p",Te,n(M(d.value.size)),1)]),e("button",{type:"button",onClick:D,class:"flex items-center justify-center w-8 h-8 rounded-lg text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 transition-colors"},[...t[15]||(t[15]=[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1)])])]),d.value&&d.value.type==="application/pdf"?(g(),c("div",Pe,[t[17]||(t[17]=e("div",{class:"bg-gray-100 dark:bg-gray-900 px-4 py-2 border-b border-gray-300 dark:border-gray-700"},[e("p",{class:"text-sm font-medium text-gray-700 dark:text-gray-400"},"Preview PDF")],-1)),e("div",Re,[e("iframe",{src:b.value,class:"w-full h-full border-0 rounded",type:"application/pdf"},null,8,Ue)])])):p("",!0)])):p("",!0)])):p("",!0)]),l.file?(g(),c("p",De,n(l.file),1)):p("",!0)])]),e("div",ze,[e("button",{onClick:C,type:"button",class:"flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] sm:w-auto"}," Batal "),e("button",{type:"submit",disabled:y.value,class:"flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 disabled:opacity-50 disabled:cursor-not-allowed sm:w-auto"},n(y.value?"Menyimpan...":x.value?"Simpan Perubahan":"Simpan"),9,Se)])],32)])]),_:1}))}});export{Ae as default};
