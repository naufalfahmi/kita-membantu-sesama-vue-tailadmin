import{g as G,N as P,H as B,I as R,B as C,r as l,o as _,c as M,a as D,w as F,f as b,b as t,t as S,z as J,j as u,l as V,v as m,q as O}from"./admin-CLxYwY0g.js";import{_ as E}from"./AdminLayout.vue_vue_type_script_setup_true_lang-B648_P3o.js";import{_ as $}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-Z11cfszT.js";import{S as T}from"./SearchableSelect-BS3xS96A.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},K={class:"mb-6 flex items-center justify-between"},z={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},H={class:"grid grid-cols-1 gap-x-6 gap-y-5 lg:grid-cols-2"},L={class:"lg:col-span-2"},X={class:"flex items-center gap-3 mt-6 lg:justify-end"},A={type:"submit",class:"flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 sm:w-auto"},ra=G({__name:"GajiForm",setup(Q){const o=P(),d=B(),c=R(),f=C(()=>d.meta.title||(g.value?"Edit Gaji":"Tambah Gaji")),g=l(!1),k=l(!1),r=l({nama:"",nominal:0,tipe:"",tanggal_efektif:"",keterangan:"",jabatan_id:"",pangkat_id:""}),x=l([]),y=l([]),v=l(""),h=l(""),i=l("");function N(){let n=i.value.replace(/[^\d.,]/g,"");n=n.replace(/\./g,""),n=n.replace(",",".");const e=parseFloat(n)||0;r.value.nominal=e,i.value=new Intl.NumberFormat("id-ID").format(e)}function w(){c.push({name:"Gaji"})}async function I(n){try{const a=await(await fetch(`/admin/api/gaji/${n}`,{credentials:"same-origin"})).json();a.success?(r.value={nama:a.data.nama||"",nominal:a.data.nominal||0,tipe:a.data.tipe||"",tanggal_efektif:a.data.tanggal_efektif||"",keterangan:a.data.keterangan||"",jabatan_id:a.data.jabatan_id?String(a.data.jabatan_id):a.data.jabatan?String(a.data.jabatan.id):"",pangkat_id:a.data.pangkat_id?String(a.data.pangkat_id):a.data.pangkat?String(a.data.pangkat.id):""},i.value=new Intl.NumberFormat("id-ID").format(r.value.nominal||0)):o.error(a.message||"Gagal memuat data")}catch{o.error("Gagal memuat data")}}async function U(){if(!r.value.nama){o.error("Nama gaji wajib diisi");return}if(!r.value.nominal||r.value.nominal<=0){o.error("Nominal gaji wajib diisi dan harus lebih dari 0");return}k.value=!0;try{const e=await(await fetch("/admin/api/csrf-token",{credentials:"same-origin"})).json(),a={nama:r.value.nama,nominal:r.value.nominal,tipe:r.value.tipe,tanggal_efektif:r.value.tanggal_efektif,keterangan:r.value.keterangan,jabatan_id:r.value.jabatan_id||null,pangkat_id:r.value.pangkat_id||null};let s="/admin/api/gaji",j="POST";g.value&&d.params.id&&(s=`/admin/api/gaji/${d.params.id}`,j="PUT");const p=await(await fetch(s,{method:j,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":e.csrf_token},credentials:"same-origin",body:JSON.stringify(a)})).json();p.success?(o.success(p.message||"Berhasil disimpan"),c.push({name:"Gaji"})):o.error(p.message||"Gagal menyimpan")}catch{o.error("Gagal menyimpan")}finally{k.value=!1}}return _(()=>{d.params.id&&(g.value=!0,I(d.params.id))}),_(async()=>{try{const[n,e]=await Promise.all([fetch("/admin/api/jabatan?per_page=1000",{credentials:"same-origin"}),fetch("/admin/api/pangkat?per_page=1000",{credentials:"same-origin"})]),a=await n.json(),s=await e.json();a&&a.success&&(x.value=a.data||[]),s&&s.success&&(y.value=s.data||[])}catch{}}),(n,e)=>(D(),M(E,null,{default:F(()=>[b($,{pageTitle:f.value},null,8,["pageTitle"]),t("div",q,[t("div",K,[t("h3",z,S(f.value),1),t("button",{onClick:w,class:"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]"}," Kembali ")]),t("form",{onSubmit:J(U,["prevent"]),class:"flex flex-col"},[t("div",H,[t("div",null,[e[9]||(e[9]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[V(" Nama "),t("span",{class:"text-red-500"},"*")],-1)),u(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>r.value.nama=a),placeholder:"Masukkan nama gaji",required:"",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[m,r.value.nama]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[V(" Nominal (Rp) "),t("span",{class:"text-red-500"},"*")],-1)),u(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>i.value=a),placeholder:"Masukkan nominal gaji",onInput:N,required:"",class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,544),[[m,i.value]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Jabatan ",-1)),b(T,{modelValue:r.value.jabatan_id,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value.jabatan_id=a),options:x.value.map(a=>({value:String(a.id),label:a.name})),placeholder:"Pilih jabatan","search-input":v.value,"onUpdate:searchInput":e[3]||(e[3]=a=>v.value=a)},null,8,["modelValue","options","search-input"])]),t("div",null,[e[12]||(e[12]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Pangkat ",-1)),b(T,{modelValue:r.value.pangkat_id,"onUpdate:modelValue":e[4]||(e[4]=a=>r.value.pangkat_id=a),options:y.value.map(a=>({value:String(a.id),label:a.nama})),placeholder:"Pilih pangkat","search-input":h.value,"onUpdate:searchInput":e[5]||(e[5]=a=>h.value=a)},null,8,["modelValue","options","search-input"])]),t("div",null,[e[14]||(e[14]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Tipe ",-1)),u(t("select",{"onUpdate:modelValue":e[6]||(e[6]=a=>r.value.tipe=a),class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800"},[...e[13]||(e[13]=[t("option",{value:""},"Pilih tipe gaji",-1),t("option",{value:"bulanan"},"Bulanan",-1),t("option",{value:"tunjangan"},"Tunjangan",-1),t("option",{value:"bonus"},"Bonus",-1)])],512),[[O,r.value.tipe]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Tanggal Efektif ",-1)),u(t("input",{type:"date","onUpdate:modelValue":e[7]||(e[7]=a=>r.value.tanggal_efektif=a),class:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[m,r.value.tanggal_efektif]])]),t("div",L,[e[16]||(e[16]=t("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"}," Keterangan ",-1)),u(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=a=>r.value.keterangan=a),placeholder:"Masukkan keterangan gaji (opsional)",rows:"3",class:"dark:bg-dark-900 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[m,r.value.keterangan]])])]),t("div",X,[t("button",{onClick:w,type:"button",class:"flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] sm:w-auto"}," Batal "),t("button",A,S(g.value?"Simpan Perubahan":"Simpan"),1)])],32)])]),_:1}))}});export{ra as default};
