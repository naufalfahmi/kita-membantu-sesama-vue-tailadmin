import{d as W,I as Q,J as Y,N as Z,B as w,b as C,f as M,g as ee,o as m,w as ae,a as e,t as g,q as d,k as K,m as E,v as A,c as b,i as P,F as L,l as J}from"./admin-JcsI97yc.js";import{_ as te}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CKLl9iLT.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},ne={class:"mb-6 flex items-center justify-between"},oe={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},ie={class:"mb-6"},de={class:"mb-6"},le={class:"mb-4 flex items-center justify-between"},ce={class:"flex items-center gap-3"},me={class:"mb-4 flex items-center gap-4 rounded-lg border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-800/50"},pe={class:"text-xs text-gray-500 dark:text-gray-400"},ge={class:"space-y-4"},be={class:"bg-gray-100 dark:bg-gray-800/50 px-4 py-3 border-b border-gray-200 dark:border-gray-700"},ue={class:"flex items-center justify-between"},ye={class:"font-semibold text-gray-800 dark:text-white/90"},xe=["onClick"],he={class:"overflow-x-auto"},ke={class:"w-full"},fe={class:"bg-gray-50 dark:bg-gray-800/30"},ve={class:"border-r border-gray-200 px-4 py-3 text-center text-xs font-semibold text-gray-700 dark:border-gray-700 dark:text-gray-300"},_e={class:"flex flex-col items-center gap-1"},we=["onClick"],Ce={class:"border-r border-gray-200 px-4 py-3 text-center text-xs font-semibold text-gray-700 dark:border-gray-700 dark:text-gray-300"},$e={class:"flex flex-col items-center gap-1"},je=["onClick"],Se={class:"border-r border-gray-200 px-4 py-3 text-center text-xs font-semibold text-gray-700 dark:border-gray-700 dark:text-gray-300"},Pe={class:"flex flex-col items-center gap-1"},Ie=["onClick"],Te={class:"border-r border-gray-200 px-4 py-3 text-center text-xs font-semibold text-gray-700 dark:border-gray-700 dark:text-gray-300"},Ke={class:"flex flex-col items-center gap-1"},Ee=["onClick"],Ae={key:0,class:"border-r border-gray-200 px-4 py-3 text-center text-xs font-semibold text-gray-700 dark:border-gray-700 dark:text-gray-300"},Le={class:"flex flex-col items-center gap-1"},Je=["onClick"],Be={class:"px-4 py-3 text-center text-xs font-semibold text-gray-700 dark:text-gray-300"},De={class:"flex flex-col items-center gap-1"},Fe=["onClick"],Ne={class:"divide-y divide-gray-200 dark:divide-gray-700"},qe={class:"sticky left-0 z-10 border-r border-gray-200 bg-white px-4 py-3 text-sm font-medium text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"},Re={class:"border-r border-gray-200 px-4 py-3 text-center dark:border-gray-700"},He=["checked","onChange"],Oe={class:"border-r border-gray-200 px-4 py-3 text-center dark:border-gray-700"},Xe=["checked","onChange"],Ve={class:"border-r border-gray-200 px-4 py-3 text-center dark:border-gray-700"},Ue=["checked","onChange"],Ge={class:"border-r border-gray-200 px-4 py-3 text-center dark:border-gray-700"},ze=["checked","onChange"],We={key:0,class:"border-r border-gray-200 px-4 py-3 text-center dark:border-gray-700"},Qe=["checked","onChange"],Ye={class:"px-4 py-3 text-center"},Ze=["checked","onChange"],Me={class:"flex items-center gap-3 mt-6 lg:justify-end"},ea=["disabled"],u="approval",aa=W({__name:"JabatanForm",setup(ta){const f=Q(),S=Y(),y=Z(),p=[{name:"Company",subItems:[{name:"Landing Profile",permission:"landing profile"},{name:"Landing Kegiatan",permission:"landing kegiatan"},{name:"Landing Program",permission:"landing program"},{name:"Landing Proposal",permission:"landing proposal"},{name:"Landing Bulletin",permission:"landing bulletin"}]},{name:"Administrasi",subItems:[{name:"Kantor Cabang",permission:"kantor cabang"},{name:"Program",permission:"program"},{name:"Jabatan",permission:"jabatan"},{name:"Pangkat",permission:"pangkat"},{name:"Tipe Absensi",permission:"tipe absensi"},{name:"Gaji",permission:"gaji"},{name:"Tipe Donatur",permission:"tipe donatur"},{name:"Form Pesan",permission:"form pesan"},{name:"SOP",permission:"sop"},{name:"Aturan Kepegawaian",permission:"aturan kepegawaian"}]},{name:"Konten & Publikasi",subItems:[{name:"Program Kami",permission:"program kami"},{name:"Profile Kami",permission:"profile kami"},{name:"Proposal Data",permission:"proposal data"},{name:"Bulletin Data",permission:"bulletin data"}]},{name:"User & Kepegawaian",subItems:[{name:"Karyawan",permission:"karyawan"},{name:"Mitra",permission:"mitra"},{name:"Donatur",permission:"donatur"}]},{name:"Operasional",subItems:[{name:"Absensi",permission:"absensi"},{name:"Payroll",permission:"payroll"},{name:"Payroll Mitra",permission:"payroll mitra"}]},{name:"Keuangan",subItems:[{name:"Keuangan",permission:"keuangan"},{name:"Penyaluran",permission:"penyaluran"},{name:"Pengajuan Dana",permission:"pengajuan dana"}]},{name:"Transaksi",subItems:[{name:"Transaksi",permission:"transaksi"}]},{name:"Laporan",subItems:[{name:"Laporan Transaksi",permission:"laporan transaksi"},{name:"Laporan Keuangan",permission:"laporan keuangan"}]}],v=["view","create","update","show","delete"],c=w(()=>f.params.id!==void 0&&f.params.id!=="new"),B=w(()=>c.value?"Edit Jabatan":"Tambah Jabatan"),_=C(c.value?f.params.id:null),$=C(!1),j=C(""),x=C({name:""}),o=C(new Set),D=w(()=>{if(!j.value)return p;const s=j.value.toLowerCase();return p.map(a=>{const t=a.subItems.filter(r=>r.name.toLowerCase().includes(s)||r.permission.toLowerCase().includes(s)||a.name.toLowerCase().includes(s));return t.length>0||a.name.toLowerCase().includes(s)?{...a,subItems:t.length>0?t:a.subItems}:null}).filter(a=>a!==null)}),F=w(()=>p.reduce((s,a)=>{let t=a.subItems.length*v.length;return a.name==="Keuangan"&&(t+=a.subItems.length),s+t},0)),N=w(()=>o.value.size),i=s=>o.value.has(s),h=s=>{o.value.has(s)?o.value.delete(s):o.value.add(s)},q=()=>{p.forEach(s=>{s.subItems.forEach(a=>{v.forEach(t=>{o.value.add(`${t} ${a.permission}`)}),s.name==="Keuangan"&&o.value.add(`${u} ${a.permission}`)})})},R=()=>{o.value.clear()},H=s=>{const a=p.find(r=>r.name===s);if(!a)return;const t=a.subItems.every(r=>v.every(n=>i(`${n} ${r.permission}`))&&(a.name==="Keuangan"?i(`${u} ${r.permission}`):!0));a.subItems.forEach(r=>{if(v.forEach(n=>{const l=`${n} ${r.permission}`;t?o.value.delete(l):o.value.add(l)}),a.name==="Keuangan"){const n=`${u} ${r.permission}`;t?o.value.delete(n):o.value.add(n)}})},O=s=>{const a=p.find(t=>t.name===s);return a?a.subItems.every(t=>v.every(r=>i(`${r} ${t.permission}`))&&(a.name==="Keuangan"?i(`${u} ${t.permission}`):!0)):!1},k=(s,a)=>{const t=p.find(n=>n.name===s);if(!t)return;const r=t.subItems.every(n=>i(`${a} ${n.permission}`));if(t.subItems.forEach(n=>{const l=`${a} ${n.permission}`;r?o.value.delete(l):o.value.add(l)}),a===u&&t.name==="Keuangan"){const n=t.subItems.every(l=>i(`${u} ${l.permission}`));t.subItems.forEach(l=>{const T=`${u} ${l.permission}`;n?o.value.delete(T):o.value.add(T)})}},X=async s=>{try{const a=await fetch(`/admin/api/jabatan/${s}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(!a.ok)throw new Error("Failed to fetch");const t=await a.json();t.success&&(x.value.name=t.data.name,o.value=new Set(t.data.permissions||[]))}catch(a){console.error("Error fetching jabatan detail:",a),y.error("Gagal memuat data jabatan")}},V=async()=>{var s;if(!x.value.name.trim()){y.error("Nama jabatan wajib diisi");return}$.value=!0;try{const a=c.value?`/admin/api/jabatan/${_.value}`:"/admin/api/jabatan",t=c.value?"PUT":"POST",r=await fetch(a,{method:t,headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},credentials:"same-origin",body:JSON.stringify({name:x.value.name,permissions:Array.from(o.value)})}),n=await r.json();if(!r.ok)throw new Error(n.message||"Failed to save");if(n.success)y.success(c.value?"Jabatan berhasil diupdate":"Jabatan berhasil ditambahkan"),S.push("/administrasi/jabatan");else throw new Error(n.message||"Failed to save")}catch(a){console.error("Error saving jabatan:",a),y.error(a.message||"Gagal menyimpan jabatan")}finally{$.value=!1}},U=async()=>{var a;const s=prompt("Masukkan nama untuk jabatan baru:",`${x.value.name} (Copy)`);if(s)try{const r=await(await fetch(`/admin/api/jabatan/${_.value}/clone`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))||""},credentials:"same-origin",body:JSON.stringify({name:s})})).json();if(r.success)y.success("Jabatan berhasil diduplikasi"),S.push("/administrasi/jabatan");else throw new Error(r.message||"Failed to clone")}catch(t){console.error("Error cloning jabatan:",t),y.error(t.message||"Gagal menduplikasi jabatan")}},G=()=>{V()},z=()=>{U()},I=()=>{S.push("/administrasi/jabatan")};return M(async()=>{c.value&&f.params.id&&(_.value=f.params.id,await X(_.value))}),(s,a)=>(m(),ee(te,null,{default:ae(()=>[e("div",se,[e("div",ne,[e("h3",oe,g(B.value),1),e("button",{onClick:I,class:"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]"}," Batal ")]),e("form",{onSubmit:d(G,["prevent"]),class:"flex flex-col"},[e("div",ie,[a[2]||(a[2]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[E(" Nama Jabatan "),e("span",{class:"text-red-500"},"*")],-1)),K(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=t=>x.value.name=t),placeholder:"Masukkan nama jabatan",required:"",maxlength:"100",class:"h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[A,x.value.name]]),a[3]||(a[3]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Maksimal 100 karakter ",-1))]),e("div",de,[e("div",le,[a[5]||(a[5]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400"}," Hak Akses (Permissions) ",-1)),e("div",ce,[K(e("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=t=>j.value=t),placeholder:"Cari menu...",class:"h-9 w-48 rounded-lg border border-gray-300 bg-transparent px-3 py-1.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-2 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"},null,512),[[A,j.value]]),c.value&&_.value?(m(),b("button",{key:0,onClick:d(z,["prevent"]),type:"button",class:"flex items-center gap-2 rounded-lg border border-brand-500 bg-transparent px-3 py-1.5 text-sm font-medium text-brand-500 hover:bg-brand-50 dark:border-brand-500 dark:hover:bg-brand-500/10"},[...a[4]||(a[4]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})],-1),E(" Duplikasi ",-1)])])):P("",!0)])]),e("div",me,[e("button",{onClick:d(q,["prevent"]),type:"button",class:"text-sm font-medium text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Centang Semua "),e("button",{onClick:d(R,["prevent"]),type:"button",class:"text-sm font-medium text-gray-600 hover:text-gray-700 dark:text-gray-400"}," Hapus Semua "),a[6]||(a[6]=e("div",{class:"flex-1"},null,-1)),e("span",pe,g(N.value)+" dari "+g(F.value)+" dipilih ",1)]),e("div",ge,[(m(!0),b(L,null,J(D.value,t=>(m(),b("div",{key:t.name,class:"rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},[e("div",be,[e("div",ue,[e("h4",ye,g(t.name),1),e("button",{onClick:d(r=>H(t.name),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"},g(O(t.name)?"Hapus Semua":"Centang Semua"),9,xe)])]),e("div",he,[e("table",ke,[e("thead",fe,[e("tr",null,[a[13]||(a[13]=e("th",{class:"sticky left-0 z-10 min-w-[200px] border-r border-gray-200 bg-gray-50 px-4 py-3 text-left text-sm font-semibold text-gray-700 dark:border-gray-700 dark:bg-gray-800/30 dark:text-gray-300"}," Sub Menu ",-1)),e("th",ve,[e("div",_e,[a[7]||(a[7]=e("span",null,"Lihat",-1)),e("button",{onClick:d(r=>k(t.name,"view"),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Toggle ",8,we)])]),e("th",Ce,[e("div",$e,[a[8]||(a[8]=e("span",null,"Buat",-1)),e("button",{onClick:d(r=>k(t.name,"create"),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Toggle ",8,je)])]),e("th",Se,[e("div",Pe,[a[9]||(a[9]=e("span",null,"Ubah",-1)),e("button",{onClick:d(r=>k(t.name,"update"),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Toggle ",8,Ie)])]),e("th",Te,[e("div",Ke,[a[10]||(a[10]=e("span",null,"Detail",-1)),e("button",{onClick:d(r=>k(t.name,"show"),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Toggle ",8,Ee)])]),t.name==="Keuangan"?(m(),b("th",Ae,[e("div",Le,[a[11]||(a[11]=e("span",null,"Approval",-1)),e("button",{onClick:d(r=>k(t.name,"approval"),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Toggle ",8,Je)])])):P("",!0),e("th",Be,[e("div",De,[a[12]||(a[12]=e("span",null,"Hapus",-1)),e("button",{onClick:d(r=>k(t.name,"delete"),["prevent"]),type:"button",class:"text-xs text-brand-600 hover:text-brand-700 dark:text-brand-400"}," Toggle ",8,Fe)])])])]),e("tbody",Ne,[(m(!0),b(L,null,J(t.subItems,r=>(m(),b("tr",{key:r.permission,class:"hover:bg-gray-50 dark:hover:bg-gray-800/20"},[e("td",qe,g(r.name),1),e("td",Re,[e("input",{type:"checkbox",checked:i(`view ${r.permission}`),onChange:n=>h(`view ${r.permission}`),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-600 dark:bg-gray-800"},null,40,He)]),e("td",Oe,[e("input",{type:"checkbox",checked:i(`create ${r.permission}`),onChange:n=>h(`create ${r.permission}`),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-600 dark:bg-gray-800"},null,40,Xe)]),e("td",Ve,[e("input",{type:"checkbox",checked:i(`update ${r.permission}`),onChange:n=>h(`update ${r.permission}`),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-600 dark:bg-gray-800"},null,40,Ue)]),e("td",Ge,[e("input",{type:"checkbox",checked:i(`show ${r.permission}`),onChange:n=>h(`show ${r.permission}`),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-600 dark:bg-gray-800"},null,40,ze)]),t.name==="Keuangan"?(m(),b("td",We,[e("input",{type:"checkbox",checked:i(`approval ${r.permission}`),onChange:n=>h(`approval ${r.permission}`),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-600 dark:bg-gray-800"},null,40,Qe)])):P("",!0),e("td",Ye,[e("input",{type:"checkbox",checked:i(`delete ${r.permission}`),onChange:n=>h(`delete ${r.permission}`),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-600 dark:bg-gray-800"},null,40,Ze)])]))),128))])])])]))),128))])]),e("div",Me,[e("button",{onClick:I,type:"button",class:"flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] sm:w-auto"}," Batal "),e("button",{type:"submit",disabled:$.value,class:"flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 disabled:opacity-50 disabled:cursor-not-allowed sm:w-auto"},g($.value?"Menyimpan...":c.value?"Simpan Perubahan":"Simpan"),9,ea)])],32)])]),_:1}))}}),oa=re(aa,[["__scopeId","data-v-32b91955"]]);export{oa as default};
