import{d as J,H as Z,I as G,b as _,e as X,M as Q,O as W,A as B,g as Y,o as d,w as ee,a as e,t as k,q as ae,k as y,c as l,i as u,m as g,n as x,v as f,F as N,l as H,C as te}from"./admin-kALM_0gO.js";import{_ as re}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Cuj5t4tU.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={class:"min-h-screen rounded-2xl border border-gray-200 bg-white px-5 py-7 dark:border-gray-800 dark:bg-white/[0.03] xl:px-10 xl:py-12"},oe={class:"mb-6"},de={class:"font-semibold text-gray-800 text-theme-xl dark:text-white/90 sm:text-2xl"},le={class:"mb-8 rounded-lg border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-white/[0.03]"},ie={class:"grid grid-cols-1 gap-x-6 gap-y-5 lg:grid-cols-2"},ue={class:"lg:col-span-1"},me={key:0,class:"mt-1 text-xs text-red-500"},be={class:"lg:col-span-1"},ce={key:0,class:"mt-1 text-xs text-red-500"},ge={class:"mb-8 rounded-lg border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-white/[0.03]"},pe={class:"mb-4 flex items-center justify-between"},ke={key:0,class:"py-8 text-center text-sm text-gray-500 dark:text-gray-400"},he={class:"mb-3 flex items-center justify-between"},ye={class:"text-sm font-medium text-gray-700 dark:text-gray-400"},xe=["onClick"],fe={class:"grid grid-cols-1 gap-x-4 gap-y-4 lg:grid-cols-2"},ve=["onUpdate:modelValue"],_e={key:0,class:"mt-1 text-xs text-red-500"},we=["onUpdate:modelValue"],Ce={key:0,class:"mt-1 text-xs text-red-500"},$e={class:"mb-8 rounded-lg border border-gray-200 bg-white p-6 dark:border-gray-800 dark:bg-white/[0.03]"},Ve={class:"mb-4 flex items-center justify-between"},Ae={key:0,class:"py-8 text-center text-sm text-gray-500 dark:text-gray-400"},je={class:"mb-3 flex items-center justify-between"},Be={class:"flex items-center gap-3"},Ne={class:"text-sm font-medium text-gray-700 dark:text-gray-400"},He={class:"flex items-center gap-2"},Ue=["onUpdate:modelValue","onChange"],Ee=["onClick"],Me={class:"grid grid-cols-1 gap-x-4 gap-y-4"},Te=["onUpdate:modelValue"],Pe={key:0,class:"mt-1 text-xs text-red-500"},Re=["onUpdate:modelValue"],Se={key:0,class:"mt-1 text-xs text-red-500"},De={class:"flex items-center gap-3 lg:justify-end"},Fe={key:0,type:"submit",class:"flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 sm:w-auto"},qe=J({__name:"LandingProfile",setup(ze){const U=Z(),E=G(),M=_(String(U.meta.title||"Landing Profile")),s=X({email:"",phone_number:"",banks:[],addresses:[]}),r=_({}),h=Q(),{fetchUser:T,hasPermission:w,isAdmin:C}=W();T();const b=B(()=>C()||w("create landing profile")),c=B(()=>C()||w("update landing profile"));let $=0,V=0;const P=()=>{if(m.value?!c.value:!b.value){h.error("Anda tidak memiliki izin untuk menambah data");return}s.banks.push({id:++$,bank_name:"",account_number:""})},R=t=>{if(m.value?!c.value:!b.value){h.error("Anda tidak memiliki izin untuk menghapus data");return}s.banks.splice(t,1),delete r.value[`banks.${t}.bank_name`],delete r.value[`banks.${t}.account_number`]},S=()=>{if(m.value?!c.value:!b.value){h.error("Anda tidak memiliki izin untuk menambah data");return}s.addresses.push({id:++V,name:"",address:"",is_primary:!1})},D=t=>{if(m.value?!c.value:!b.value){h.error("Anda tidak memiliki izin untuk menghapus data");return}s.addresses.splice(t,1),delete r.value[`addresses.${t}.name`],delete r.value[`addresses.${t}.address`]},F=t=>{s.addresses[t].is_primary&&s.addresses.forEach((a,n)=>{n!==t&&(a.is_primary=!1)})},q=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),z=t=>/^[0-9]{1,15}$/.test(t),L=()=>{const t=s.banks.map(a=>a.account_number.trim()).filter(a=>a!=="");return new Set(t).size!==t.length},O=()=>(r.value={},s.email?q(s.email)||(r.value.email="Format email tidak valid"):r.value.email="Email wajib diisi",s.phone_number?z(s.phone_number)||(r.value.phone_number="No. Handphone harus berupa angka (maksimal 15 digit)"):r.value.phone_number="No. Handphone wajib diisi",s.banks.forEach((t,a)=>{t.bank_name.trim()||(r.value[`banks.${a}.bank_name`]="Nama Bank wajib diisi"),t.account_number.trim()?/^[0-9]+$/.test(t.account_number.trim())||(r.value[`banks.${a}.account_number`]="No. Rekening harus berupa angka"):r.value[`banks.${a}.account_number`]="No. Rekening wajib diisi"}),L()?(alert("Terdapat nomor rekening yang duplikat. Harap periksa kembali."),!1):(s.addresses.forEach((t,a)=>{t.name.trim()||(r.value[`addresses.${a}.name`]="Nama wajib diisi"),t.address.trim()||(r.value[`addresses.${a}.address`]="Alamat wajib diisi")}),Object.keys(r.value).length===0)),K=()=>{confirm("Apakah Anda yakin ingin membatalkan? Perubahan yang belum disimpan akan hilang.")&&E.back()},I=async()=>{if(m.value?!c.value:!b.value){h.error("Anda tidak memiliki izin untuk menyimpan data");return}if(O())try{const t={email:s.email,phone_number:s.phone_number,bank_account_1:s.banks.map(p=>({label:p.bank_name.trim(),value:p.account_number.trim()})),address:s.addresses.map(p=>({label:p.name.trim(),value:p.address.trim(),is_primary:!!p.is_primary}))},a=await fetch("/admin/api/csrf-token",{credentials:"same-origin"});if(!a.ok)throw new Error("Failed to fetch CSRF token");const n=await a.json(),o=m.value?"PUT":"POST",j=await fetch("/admin/api/company/landing-profile",{method:o,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n.csrf_token},credentials:"same-origin",body:JSON.stringify(t)}),v=await j.json().catch(()=>({}));if(j.ok&&v.success)h.success("Data berhasil disimpan"),await A();else throw v.errors&&Object.keys(v.errors).forEach(p=>{r.value[p]=v.errors[p][0]}),new Error(v.message||"Gagal menyimpan data")}catch(t){console.error("Error saving:",t),h.error(t.message||"Terjadi kesalahan saat menyimpan data")}},A=async()=>{try{const t=await fetch("/admin/api/company/landing-profile",{credentials:"same-origin"});if(!t.ok)throw new Error("Failed to load landing profile");const a=await t.json();if(a.success&&a.data){const n=a.data;m.value=n,s.email=n.email||"",s.phone_number=n.phone_number||"",s.banks=Array.isArray(n.bank_account_1)?n.bank_account_1.map((o,i)=>({id:++$,bank_name:o.label||o.bank_name||"",account_number:String(o.value||"")})):[],s.addresses=Array.isArray(n.address)?n.address.map((o,i)=>({id:++V,name:o.label||o.name||"",address:o.value||"",is_primary:!!o.is_primary})):[]}}catch(t){console.error("Error loading data:",t)}},m=_(null);return A(),(t,a)=>(d(),Y(re,null,{default:ee(()=>[e("div",ne,[e("div",oe,[e("h3",de,k(M.value),1)]),e("form",{onSubmit:ae(I,["prevent"]),class:"flex flex-col"},[e("div",le,[a[4]||(a[4]=e("h4",{class:"mb-4 text-lg font-semibold text-gray-800 dark:text-white/90"}," Data Kontak ",-1)),e("div",ie,[e("div",ue,[a[2]||(a[2]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[g(" Email "),e("span",{class:"text-red-500"},"*")],-1)),y(e("input",{type:"email","onUpdate:modelValue":a[0]||(a[0]=n=>s.email=n),placeholder:"contoh@email.com",required:"",class:x(["dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",{"border-red-500":r.value.email}])},null,2),[[f,s.email]]),r.value.email?(d(),l("p",me,k(r.value.email),1)):u("",!0)]),e("div",be,[a[3]||(a[3]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[g(" No. Handphone "),e("span",{class:"text-red-500"},"*")],-1)),y(e("input",{type:"tel","onUpdate:modelValue":a[1]||(a[1]=n=>s.phone_number=n),placeholder:"081234567890",required:"",maxlength:"15",class:x(["dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",{"border-red-500":r.value.phone_number}])},null,2),[[f,s.phone_number]]),r.value.phone_number?(d(),l("p",ce,k(r.value.phone_number),1)):u("",!0)])])]),e("div",ge,[e("div",pe,[a[6]||(a[6]=e("h4",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"}," List Bank ",-1)),(m.value?c.value:b.value)?(d(),l("button",{key:0,type:"button",onClick:P,class:"flex items-center gap-2 rounded-lg bg-brand-500 px-4 py-2 text-sm font-medium text-white hover:bg-brand-600"},[...a[5]||(a[5]=[e("svg",{class:"fill-current",width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 3.33333C10.4602 3.33333 10.8333 3.70643 10.8333 4.16667V9.16667H15.8333C16.2936 9.16667 16.6667 9.53976 16.6667 10C16.6667 10.4602 16.2936 10.8333 15.8333 10.8333H10.8333V15.8333C10.8333 16.2936 10.4602 16.6667 10 16.6667C9.53976 16.6667 9.16667 16.2936 9.16667 15.8333V10.8333H4.16667C3.70643 10.8333 3.33333 10.4602 3.33333 10C3.33333 9.53976 3.70643 9.16667 4.16667 9.16667H9.16667V4.16667C9.16667 3.70643 9.53976 3.33333 10 3.33333Z",fill:"currentColor"})],-1),g(" Tambah Bank ",-1)])])):u("",!0)]),s.banks.length===0?(d(),l("div",ke,' Belum ada data bank. Klik tombol "Tambah Bank" untuk menambahkan. ')):u("",!0),(d(!0),l(N,null,H(s.banks,(n,o)=>(d(),l("div",{key:n.id,class:"mb-4 rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},[e("div",he,[e("span",ye," Bank #"+k(o+1),1),(m.value?c.value:b.value)?(d(),l("button",{key:0,type:"button",onClick:i=>R(o),class:"flex items-center gap-1 rounded-lg border border-red-300 bg-white px-3 py-1.5 text-xs font-medium text-red-600 hover:bg-red-50 dark:border-red-700 dark:bg-gray-800 dark:text-red-400 dark:hover:bg-red-900/20"},[...a[7]||(a[7]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M3 6h18"}),e("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})],-1),g(" Hapus Bank ",-1)])],8,xe)):u("",!0)]),e("div",fe,[e("div",null,[a[8]||(a[8]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[g(" Nama Bank "),e("span",{class:"text-red-500"},"*")],-1)),y(e("input",{type:"text","onUpdate:modelValue":i=>n.bank_name=i,placeholder:"Contoh: Bank Mandiri",required:"",class:x(["dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",{"border-red-500":r.value[`banks.${o}.bank_name`]}])},null,10,ve),[[f,n.bank_name]]),r.value[`banks.${o}.bank_name`]?(d(),l("p",_e,k(r.value[`banks.${o}.bank_name`]),1)):u("",!0)]),e("div",null,[a[9]||(a[9]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[g(" No. Rekening "),e("span",{class:"text-red-500"},"*")],-1)),y(e("input",{type:"text","onUpdate:modelValue":i=>n.account_number=i,placeholder:"Contoh: 1234567890",required:"",class:x(["dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",{"border-red-500":r.value[`banks.${o}.account_number`]}])},null,10,we),[[f,n.account_number]]),r.value[`banks.${o}.account_number`]?(d(),l("p",Ce,k(r.value[`banks.${o}.account_number`]),1)):u("",!0)])])]))),128))]),e("div",$e,[e("div",Ve,[a[11]||(a[11]=e("h4",{class:"text-lg font-semibold text-gray-800 dark:text-white/90"}," List Alamat ",-1)),(m.value?c.value:b.value)?(d(),l("button",{key:0,type:"button",onClick:S,class:"flex items-center gap-2 rounded-lg bg-brand-500 px-4 py-2 text-sm font-medium text-white hover:bg-brand-600"},[...a[10]||(a[10]=[e("svg",{class:"fill-current",width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 3.33333C10.4602 3.33333 10.8333 3.70643 10.8333 4.16667V9.16667H15.8333C16.2936 9.16667 16.6667 9.53976 16.6667 10C16.6667 10.4602 16.2936 10.8333 15.8333 10.8333H10.8333V15.8333C10.8333 16.2936 10.4602 16.6667 10 16.6667C9.53976 16.6667 9.16667 16.2936 9.16667 15.8333V10.8333H4.16667C3.70643 10.8333 3.33333 10.4602 3.33333 10C3.33333 9.53976 3.70643 9.16667 4.16667 9.16667H9.16667V4.16667C9.16667 3.70643 9.53976 3.33333 10 3.33333Z",fill:"currentColor"})],-1),g(" Tambah Alamat ",-1)])])):u("",!0)]),s.addresses.length===0?(d(),l("div",Ae,' Belum ada data alamat. Klik tombol "Tambah Alamat" untuk menambahkan. ')):u("",!0),(d(!0),l(N,null,H(s.addresses,(n,o)=>(d(),l("div",{key:n.id,class:"mb-4 rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-800/50"},[e("div",je,[e("div",Be,[e("span",Ne," Alamat #"+k(o+1),1),e("label",He,[y(e("input",{type:"checkbox","onUpdate:modelValue":i=>n.is_primary=i,onChange:i=>F(o),class:"h-4 w-4 rounded border-gray-300 text-brand-500 focus:ring-brand-500 dark:border-gray-600 dark:bg-gray-700"},null,40,Ue),[[te,n.is_primary]]),a[12]||(a[12]=e("span",{class:"text-xs text-gray-600 dark:text-gray-400"},"Alamat Utama",-1))])]),(m.value?c.value:b.value)?(d(),l("button",{key:0,type:"button",onClick:i=>D(o),class:"flex items-center gap-1 rounded-lg border border-red-300 bg-white px-3 py-1.5 text-xs font-medium text-red-600 hover:bg-red-50 dark:border-red-700 dark:bg-gray-800 dark:text-red-400 dark:hover:bg-red-900/20"},[...a[13]||(a[13]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M3 6h18"}),e("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})],-1),g(" Hapus Alamat ",-1)])],8,Ee)):u("",!0)]),e("div",Me,[e("div",null,[a[14]||(a[14]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[g(" Nama "),e("span",{class:"text-red-500"},"*")],-1)),y(e("input",{type:"text","onUpdate:modelValue":i=>n.name=i,placeholder:"Contoh: Kantor Pusat",required:"",class:x(["dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",{"border-red-500":r.value[`addresses.${o}.name`]}])},null,10,Te),[[f,n.name]]),r.value[`addresses.${o}.name`]?(d(),l("p",Pe,k(r.value[`addresses.${o}.name`]),1)):u("",!0)]),e("div",null,[a[15]||(a[15]=e("label",{class:"mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400"},[g(" Alamat "),e("span",{class:"text-red-500"},"*")],-1)),y(e("textarea",{"onUpdate:modelValue":i=>n.address=i,placeholder:"Masukkan alamat lengkap",rows:"3",required:"",class:x(["dark:bg-dark-900 w-full rounded-lg border border-gray-300 bg-transparent bg-none px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800",{"border-red-500":r.value[`addresses.${o}.address`]}])},null,10,Re),[[f,n.address]]),r.value[`addresses.${o}.address`]?(d(),l("p",Se,k(r.value[`addresses.${o}.address`]),1)):u("",!0)])])]))),128))]),e("div",De,[e("button",{type:"button",onClick:K,class:"flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03] sm:w-auto"}," Batal "),(m.value?c.value:b.value)?(d(),l("button",Fe," Simpan ")):u("",!0)])],32)])]),_:1}))}}),Ie=se(qe,[["__scopeId","data-v-6ed340d1"]]);export{Ie as default};
